{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/typeedit/styles/app.scss","webpack:///./src/typeedit/styles/app/editor.scss","webpack:///./src/typeedit/styles/app/main.scss","webpack:///./src/typeedit/styles/app/panel.scss","webpack:///./src/typeedit/styles/welcome.scss","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./src/editor.ts","webpack:///./src/typeedit/app.ts","webpack:///./src/typeedit/font/font.ts","webpack:///./src/typeedit/font/glyph.ts","webpack:///./src/typeedit/geometry/bezier/curve.ts","webpack:///./src/typeedit/geometry/bezier/point.ts","webpack:///./src/typeedit/geometry/point.ts","webpack:///./src/typeedit/io/ftex/ftex.ts","webpack:///./src/typeedit/io/io.ts","webpack:///./src/typeedit/io/opentype.js/export.ts","webpack:///./src/typeedit/io/opentype.js/import.ts","webpack:///./src/typeedit/io/otfcc/import.ts","webpack:///./src/typeedit/settings/defaults.ts","webpack:///./src/typeedit/settings/proxy.ts","webpack:///./src/typeedit/settings/settings.ts","webpack:///./src/typeedit/styles/app.scss?0117","webpack:///./src/typeedit/styles/app/editor.scss?40f5","webpack:///./src/typeedit/styles/app/main.scss?2c16","webpack:///./src/typeedit/styles/app/panel.scss?aa71","webpack:///./src/typeedit/styles/welcome.scss?4869","webpack:///./src/typeedit/ui/actionbar.ts","webpack:///./src/typeedit/ui/glyphBar.ts","webpack:///./src/typeedit/ui/glyphList.ts","webpack:///./src/typeedit/ui/panel.ts","webpack:///./src/typeedit/ui/theme.ts","webpack:///./src/typeedit/ui/toolbar.ts","webpack:///./src/typeedit/ui/viewport.ts","webpack:///./src/typeedit/undo/actions/array.ts","webpack:///./src/typeedit/undo/actions/value.ts","webpack:///./src/typeedit/undo/context.ts","webpack:///./src/typeedit/undo/history.ts","webpack:///./src/typeedit/utils/accelerator.ts","webpack:///./src/typeedit/utils/lerp.ts","webpack:///./src/typeedit/utils/preview.ts","webpack:///./src/typeedit/viewport/context/bezier.ts","webpack:///./src/typeedit/viewport/context/glyph.ts","webpack:///./src/typeedit/viewport/coordinates.ts","webpack:///./src/typeedit/viewport/guides/curve.ts","webpack:///./src/typeedit/viewport/guides/grid.ts","webpack:///./src/typeedit/viewport/guides/line.ts","webpack:///./src/typeedit/viewport/guides/point.ts","webpack:///./src/typeedit/viewport/handles/bezierBasePoint.ts","webpack:///./src/typeedit/viewport/handles/bezierControlPoint.ts","webpack:///./src/typeedit/viewport/handles/fontMetric.ts","webpack:///./src/typeedit/viewport/tools/bezierPen.ts","webpack:///./src/typeedit/viewport/tools/ellipse.ts","webpack:///./src/typeedit/viewport/tools/handle.ts","webpack:///./src/typeedit/viewport/tools/rectangle.ts","webpack:///./src/typeedit/viewport/viewport.ts","webpack:///external \"child_process\"","webpack:///external \"electron\"","webpack:///external \"events\"","webpack:///external \"fs\"","webpack:///external \"opentype.js\"","webpack:///external \"paper\"","webpack:///external \"path\"","webpack:///external \"smart-buffer\"","webpack:///external \"zlib\""],"names":[],"mappings":"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;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAwC,GAAG,sBAAiB,GAAG,SAAI;;AAEnF;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,qEAAqE,qBAAqB,aAAa;;AAEvG;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,yDAAyD;AACzD,GAAG;;AAEH;;;AAGA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;;AAEA;;AAEA,oBAAoB,6BAA6B;AACjD;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5QmC;AACK;AACC;AACC;AAEH;AAEU;AACxB;AACQ;AACO;AAEG;AAEiB;AACH;AACG;AAGP;AACwB;AAE7E,OAAO,CAAC,GAAG,CAAC,+CAAM,CAAC;AAEnB,IAAM,KAAK,GAAG,IAAI,4CAAK,CAAC,UAAU,EAAE;AACpC,KAAK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","file":"editor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/editor.ts\");\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \":root {\\n  --var-large-bg: #fff;\\n  --var-panel-bg: #f6f6f6;\\n  --var-text-fg: #000;\\n  --var-panel-sep: #d1d1d1;\\n  --var-button-bg: #fff;\\n  --var-button-hover: #eee;\\n  --var-button-active: #c0c0c0;\\n  --var-glist-label: #fafafa;\\n  --var-glist-activeLabel: #6d7599; }\\n\\nbody {\\n  background: var(--var-large-bg);\\n  color: var(--var-text-fg);\\n  font-family: \\\"Inter\\\";\\n  user-select: none; }\\n\\n*::-webkit-scrollbar {\\n  width: 12px; }\\n\\n*::-webkit-scrollbar-track {\\n  background: var(--var-panel-sep); }\\n\\n*::-webkit-scrollbar-thumb {\\n  background: var(--var-large-bg); }\\n\\nbody[data-theme=dark] {\\n  --var-large-bg: #222;\\n  --var-panel-bg: #161616;\\n  --var-text-fg: #fff;\\n  --var-panel-sep: #000;\\n  --var-button-bg: #111;\\n  --var-button-hover: #333;\\n  --var-button-active: #555;\\n  --var-glist-label: #2b2b2b;\\n  --var-glist-activeLabel: #232c53; }\\n  body[data-theme=dark] button > img {\\n    filter: invert(1) hue-rotate(180deg); }\\n  body[data-theme=dark] div.glyphList canvas {\\n    filter: invert(1); }\\n\\nbutton > img {\\n  width: 16px;\\n  height: 16px; }\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/typeedit/styles/app.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,oBAAe;EACf,uBAAe;EACf,mBAAc;EAEd,wBAAgB;EAEhB,qBAAgB;EAChB,wBAAmB;EACnB,4BAAoB;EAEpB,0BAAkB;EAClB,gCAAwB,EAAA;;AAG5B;EACI,+BAA+B;EAC/B,yBAAyB;EAEzB,oBAAoB;EAEpB,iBAAiB,EAAA;;AAGrB;EACI,WAAW,EAAA;;AAGf;EACI,gCAAgC,EAAA;;AAGpC;EACI,+BAA+B,EAAA;;AAGnC;EACI,oBAAe;EACf,uBAAe;EACf,mBAAc;EAEd,qBAAgB;EAEhB,qBAAgB;EAChB,wBAAmB;EACnB,yBAAoB;EAEpB,0BAAkB;EAClB,gCAAwB,EAAA;EAZ5B;IAeQ,oCAAoC,EAAA;EAf5C;IAmBQ,iBAAiB,EAAA;;AAIzB;EACI,WAAW;EACX,YAAY,EAAA\",\"sourcesContent\":[\":root {\\r\\n    --var-large-bg: #fff;\\r\\n    --var-panel-bg: #f6f6f6;\\r\\n    --var-text-fg: #000;\\r\\n\\r\\n    --var-panel-sep: #d1d1d1;\\r\\n\\r\\n    --var-button-bg: #fff;\\r\\n    --var-button-hover: #eee;\\r\\n    --var-button-active: #c0c0c0;\\r\\n\\r\\n    --var-glist-label: #fafafa;\\r\\n    --var-glist-activeLabel: #6d7599;\\r\\n}\\r\\n\\r\\nbody {\\r\\n    background: var(--var-large-bg);\\r\\n    color: var(--var-text-fg);\\r\\n\\r\\n    font-family: \\\"Inter\\\";\\r\\n\\r\\n    user-select: none;\\r\\n}\\r\\n\\r\\n*::-webkit-scrollbar {\\r\\n    width: 12px;\\r\\n}\\r\\n\\r\\n*::-webkit-scrollbar-track {\\r\\n    background: var(--var-panel-sep);\\r\\n}\\r\\n\\r\\n*::-webkit-scrollbar-thumb {\\r\\n    background: var(--var-large-bg);\\r\\n}\\r\\n\\r\\nbody[data-theme=dark] {\\r\\n    --var-large-bg: #222;\\r\\n    --var-panel-bg: #161616;\\r\\n    --var-text-fg: #fff;\\r\\n\\r\\n    --var-panel-sep: #000;\\r\\n\\r\\n    --var-button-bg: #111;\\r\\n    --var-button-hover: #333;\\r\\n    --var-button-active: #555;\\r\\n\\r\\n    --var-glist-label: #2b2b2b;\\r\\n    --var-glist-activeLabel: #232c53;\\r\\n\\r\\n    button > img {\\r\\n        filter: invert(1) hue-rotate(180deg);\\r\\n    }\\r\\n\\r\\n    div.glyphList canvas {\\r\\n        filter: invert(1);\\r\\n    }\\r\\n}\\r\\n \\r\\nbutton > img {\\r\\n    width: 16px;\\r\\n    height: 16px;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"section.edit {\\n  position: relative;\\n  border-top: 1px solid var(--var-panel-sep);\\n  display: grid;\\n  grid-template-columns: auto 1fr;\\n  grid-template-rows: 1fr auto; }\\n  section.edit div.viewport {\\n    position: relative; }\\n    section.edit div.viewport canvas {\\n      position: absolute;\\n      left: 0;\\n      top: 0; }\\n  section.edit div.glyphBar {\\n    color: var(--var-text-fg);\\n    font-family: \\\"Inter\\\";\\n    font-size: 24pt;\\n    text-align: center;\\n    border: none;\\n    outline: none;\\n    padding: 6px 20px; }\\n    section.edit div.glyphBar div.ntglyph {\\n      height: 1em;\\n      box-sizing: border-box;\\n      background: var(--var-button-hover);\\n      border-radius: 4px;\\n      border: 1px solid #ddd;\\n      margin: 0px 1px;\\n      display: inline-flex;\\n      align-items: center; }\\n      section.edit div.glyphBar div.ntglyph span {\\n        font-size: 16pt; }\\n  section.edit div.glyphSwitchButtons {\\n    position: absolute;\\n    left: 8px;\\n    right: 8px;\\n    top: 0;\\n    bottom: 0;\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    pointer-events: none; }\\n  section.edit button.prevGlyph,\\n  section.edit button.nextGlyph {\\n    background: var(--var-button-bg);\\n    font-size: 0;\\n    outline: none;\\n    padding: 6px 8px;\\n    border-radius: 4px;\\n    border: 1px solid var(--var-panel-sep);\\n    box-shadow: 0px 2px 4px #0001;\\n    pointer-events: all;\\n    z-index: 10; }\\n    section.edit button.prevGlyph:hover,\\n    section.edit button.nextGlyph:hover {\\n      background: var(--var-button-hover); }\\n    section.edit button.prevGlyph:active,\\n    section.edit button.nextGlyph:active {\\n      background: var(--var-button-active); }\\n  section.edit div.tools {\\n    background: var(--var-panel-bg);\\n    padding: 2px;\\n    display: flex;\\n    flex-direction: column;\\n    border-right: 1px solid var(--var-panel-sep);\\n    grid-row: 1 / span 2; }\\n    section.edit div.tools button {\\n      background: transparent;\\n      font-size: 0;\\n      border: none;\\n      outline: none;\\n      padding: 7px 8px;\\n      border-radius: 4px; }\\n      section.edit div.tools button:hover {\\n        background: var(--var-button-hover); }\\n      section.edit div.tools button:active {\\n        background: var(--var-button-active); }\\n      section.edit div.tools button.active {\\n        background: var(--var-panel-sep); }\\n\\ndiv.subactions {\\n  display: flex; }\\n  div.subactions div {\\n    border-left: 1px solid var(--var-panel-sep);\\n    display: flex; }\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/typeedit/styles/app/editor.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,kBAAkB;EAElB,0CAA0C;EAE1C,aAAa;EACb,+BAA+B;EAC/B,4BAA4B,EAAA;EAPhC;IAUQ,kBAAkB,EAAA;IAV1B;MAaY,kBAAkB;MAClB,OAAO;MACP,MAAM,EAAA;EAflB;IAoBQ,yBAAyB;IAEzB,oBAAoB;IACpB,eAAe;IACf,kBAAkB;IAElB,YAAY;IACZ,aAAa;IACb,iBAAiB,EAAA;IA5BzB;MA+BY,WAAW;MACX,sBAAsB;MAEtB,mCAAmC;MACnC,kBAAkB;MAClB,sBAAsB;MACtB,eAAe;MAEf,oBAAoB;MACpB,mBAAmB,EAAA;MAxC/B;QA2CgB,eAAe,EAAA;EA3C/B;IAiDQ,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,MAAM;IACN,SAAS;IAET,aAAa;IACb,8BAA8B;IAC9B,mBAAmB;IACnB,oBAAoB,EAAA;EA1D5B;;IA+DQ,gCAAgC;IAEhC,YAAY;IAEZ,aAAa;IACb,gBAAgB;IAChB,kBAAkB;IAClB,sCAAsC;IACtC,6BAA6B;IAE7B,mBAAmB;IACnB,WAAW,EAAA;IA1EnB;;MA6EY,mCAAmC,EAAA;IA7E/C;;MAiFY,oCAAoC,EAAA;EAjFhD;IAsFQ,+BAA+B;IAE/B,YAAY;IAEZ,aAAa;IACb,sBAAsB;IAEtB,4CAA4C;IAE5C,oBAAoB,EAAA;IA/F5B;MAkGY,uBAAuB;MAEvB,YAAY;MAEZ,YAAY;MACZ,aAAa;MACb,gBAAgB;MAChB,kBAAkB,EAAA;MAzG9B;QA4GgB,mCAAmC,EAAA;MA5GnD;QAgHgB,oCAAoC,EAAA;MAhHpD;QAoHgB,gCAAgC,EAAA;;AAMhD;EACI,aAAa,EAAA;EADjB;IAIQ,2CAA2C;IAC3C,aAAa,EAAA\",\"sourcesContent\":[\"section.edit {\\r\\n    position: relative;\\r\\n\\r\\n    border-top: 1px solid var(--var-panel-sep);\\r\\n\\r\\n    display: grid;\\r\\n    grid-template-columns: auto 1fr;\\r\\n    grid-template-rows: 1fr auto;\\r\\n\\r\\n    div.viewport {\\r\\n        position: relative;\\r\\n\\r\\n        canvas {\\r\\n            position: absolute;\\r\\n            left: 0;\\r\\n            top: 0;\\r\\n        }\\r\\n    }\\r\\n\\r\\n    div.glyphBar {\\r\\n        color: var(--var-text-fg);\\r\\n\\r\\n        font-family: \\\"Inter\\\";\\r\\n        font-size: 24pt;\\r\\n        text-align: center;\\r\\n\\r\\n        border: none;\\r\\n        outline: none;\\r\\n        padding: 6px 20px;\\r\\n\\r\\n        div.ntglyph {\\r\\n            height: 1em;\\r\\n            box-sizing: border-box;\\r\\n\\r\\n            background: var(--var-button-hover);\\r\\n            border-radius: 4px;\\r\\n            border: 1px solid #ddd;\\r\\n            margin: 0px 1px;\\r\\n\\r\\n            display: inline-flex;\\r\\n            align-items: center;\\r\\n\\r\\n            span {            \\r\\n                font-size: 16pt;\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    div.glyphSwitchButtons {\\r\\n        position: absolute;\\r\\n        left: 8px;\\r\\n        right: 8px;\\r\\n        top: 0;\\r\\n        bottom: 0;\\r\\n\\r\\n        display: flex;\\r\\n        justify-content: space-between;\\r\\n        align-items: center;\\r\\n        pointer-events: none;\\r\\n    }\\r\\n\\r\\n    button.prevGlyph,\\r\\n    button.nextGlyph {\\r\\n        background: var(--var-button-bg);\\r\\n\\r\\n        font-size: 0;\\r\\n\\r\\n        outline: none;\\r\\n        padding: 6px 8px;\\r\\n        border-radius: 4px;\\r\\n        border: 1px solid var(--var-panel-sep);\\r\\n        box-shadow: 0px 2px 4px #0001;\\r\\n\\r\\n        pointer-events: all;\\r\\n        z-index: 10;\\r\\n    \\r\\n        &:hover {\\r\\n            background: var(--var-button-hover);\\r\\n        }\\r\\n    \\r\\n        &:active {\\r\\n            background: var(--var-button-active);\\r\\n        }\\r\\n    }\\r\\n\\r\\n    div.tools {\\r\\n        background: var(--var-panel-bg);\\r\\n\\r\\n        padding: 2px;\\r\\n\\r\\n        display: flex;\\r\\n        flex-direction: column;\\r\\n\\r\\n        border-right: 1px solid var(--var-panel-sep);\\r\\n\\r\\n        grid-row: 1 / span 2;\\r\\n\\r\\n        button {\\r\\n            background: transparent;\\r\\n\\r\\n            font-size: 0;\\r\\n\\r\\n            border: none;\\r\\n            outline: none;\\r\\n            padding: 7px 8px;\\r\\n            border-radius: 4px;\\r\\n    \\r\\n            &:hover {\\r\\n                background: var(--var-button-hover);\\r\\n            }\\r\\n    \\r\\n            &:active {\\r\\n                background: var(--var-button-active);\\r\\n            }\\r\\n\\r\\n            &.active {\\r\\n                background: var(--var-panel-sep);\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\\r\\ndiv.subactions {    \\r\\n    display: flex;\\r\\n\\r\\n    div {\\r\\n        border-left: 1px solid var(--var-panel-sep); \\r\\n        display: flex;\\r\\n    }\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"main {\\n  position: fixed;\\n  left: 0;\\n  top: 0;\\n  right: 320px;\\n  bottom: 0;\\n  background: var(--var-panel-bg);\\n  display: flex;\\n  flex-direction: column;\\n  align-items: flex-start; }\\n  main > nav {\\n    width: 100%;\\n    padding: 0px;\\n    display: flex; }\\n    main > nav div.actions {\\n      display: flex; }\\n      main > nav div.actions button {\\n        background: transparent;\\n        border: none;\\n        outline: none;\\n        padding: 7px 10px;\\n        border-radius: 4px;\\n        margin-bottom: 2px;\\n        display: flex;\\n        align-items: center;\\n        justify-content: center; }\\n        main > nav div.actions button:hover {\\n          background: var(--var-button-hover); }\\n        main > nav div.actions button:active {\\n          background: var(--var-button-active); }\\n    main > nav div.tabs {\\n      display: flex;\\n      flex-grow: 1;\\n      justify-content: center; }\\n      main > nav div.tabs button {\\n        background: transparent;\\n        font-family: \\\"Inter\\\";\\n        font-size: 10pt;\\n        font-weight: 500;\\n        padding: 6px 20px;\\n        border: none;\\n        border-bottom: none;\\n        border-radius: 2px 2px 0px 0px;\\n        outline: none; }\\n        main > nav div.tabs button.active {\\n          background: #fff; }\\n  main section {\\n    position: relative;\\n    background: var(--var-large-bg);\\n    width: 100%;\\n    flex-grow: 1; }\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/typeedit/styles/app/main.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,eAAe;EACf,OAAO;EACP,MAAM;EACN,YAAY;EACZ,SAAS;EAET,+BAA+B;EAE/B,aAAa;EACb,sBAAsB;EACtB,uBAAuB,EAAA;EAX3B;IAcQ,WAAW;IAEX,YAAY;IAEZ,aAAa,EAAA;IAlBrB;MAqBY,aAAa,EAAA;MArBzB;QAwBgB,uBAAuB;QAEvB,YAAY;QACZ,aAAa;QACb,iBAAiB;QACjB,kBAAkB;QAClB,kBAAkB;QAElB,aAAa;QACb,mBAAmB;QACnB,uBAAuB,EAAA;QAlCvC;UAqCoB,mCAAmC,EAAA;QArCvD;UAyCoB,oCAAoC,EAAA;IAzCxD;MA+CY,aAAa;MACb,YAAY;MACZ,uBAAuB,EAAA;MAjDnC;QAoDgB,uBAAuB;QAEvB,oBAAoB;QACpB,eAAe;QACf,gBAAgB;QAEhB,iBAAiB;QACjB,YAAY;QACZ,mBAAmB;QACnB,8BAA8B;QAC9B,aAAa,EAAA;QA9D7B;UAiEoB,gBAAgB,EAAA;EAjEpC;IAwEQ,kBAAkB;IAElB,+BAA+B;IAE/B,WAAW;IAEX,YAAY,EAAA\",\"sourcesContent\":[\"main {\\r\\n    position: fixed;\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n    right: 320px;\\r\\n    bottom: 0;\\r\\n\\r\\n    background: var(--var-panel-bg);\\r\\n\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: flex-start;\\r\\n\\r\\n    & > nav {\\r\\n        width: 100%;\\r\\n\\r\\n        padding: 0px;\\r\\n\\r\\n        display: flex;\\r\\n\\r\\n        div.actions {\\r\\n            display: flex;\\r\\n\\r\\n            button {    \\r\\n                background: transparent;\\r\\n    \\r\\n                border: none;\\r\\n                outline: none;\\r\\n                padding: 7px 10px;\\r\\n                border-radius: 4px;\\r\\n                margin-bottom: 2px;\\r\\n    \\r\\n                display: flex;\\r\\n                align-items: center;\\r\\n                justify-content: center;\\r\\n    \\r\\n                &:hover {\\r\\n                    background: var(--var-button-hover);\\r\\n                }\\r\\n    \\r\\n                &:active {\\r\\n                    background: var(--var-button-active);\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        div.tabs {\\r\\n            display: flex;\\r\\n            flex-grow: 1;\\r\\n            justify-content: center;\\r\\n\\r\\n            button {\\r\\n                background: transparent;\\r\\n    \\r\\n                font-family: \\\"Inter\\\";\\r\\n                font-size: 10pt;\\r\\n                font-weight: 500;\\r\\n    \\r\\n                padding: 6px 20px;\\r\\n                border: none;\\r\\n                border-bottom: none;\\r\\n                border-radius: 2px 2px 0px 0px;\\r\\n                outline: none;\\r\\n    \\r\\n                &.active {\\r\\n                    background: #fff;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    section {\\r\\n        position: relative;\\r\\n\\r\\n        background: var(--var-large-bg);\\r\\n\\r\\n        width: 100%;\\r\\n\\r\\n        flex-grow: 1;\\r\\n    }\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"aside {\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  bottom: 0;\\n  min-width: 320px;\\n  width: 320px;\\n  box-sizing: border-box;\\n  border-left: 1px solid var(--var-panel-sep);\\n  display: flex;\\n  flex-direction: column; }\\n  aside nav {\\n    background: var(--var-panel-bg);\\n    display: flex;\\n    justify-content: center; }\\n    aside nav button {\\n      background: transparent;\\n      color: var(--var-text-fg);\\n      font-family: \\\"Inter\\\";\\n      font-size: 10pt;\\n      font-weight: 400;\\n      padding: 7px 20px;\\n      border: none;\\n      border-bottom: none;\\n      outline: none; }\\n      aside nav button.tool {\\n        background: linear-gradient(transparent, #293844); }\\n      aside nav button:hover {\\n        background: var(--var-button-hover); }\\n      aside nav button:active {\\n        background: var(--var-button-active); }\\n      aside nav button.active {\\n        background: var(--var-panel-sep);\\n        box-shadow: inset 0px -2px var(--var-text-fg); }\\n  aside div.listContainer {\\n    height: 0;\\n    flex-grow: 1;\\n    overflow-y: scroll; }\\n  aside div.panelContents:not(.active) {\\n    display: none; }\\n  aside div.glyphList {\\n    background: var(--var-panel-bg);\\n    display: grid;\\n    grid-template-columns: repeat(4, 1fr);\\n    gap: 1px; }\\n    aside div.glyphList div.glyph {\\n      max-width: 75px;\\n      background: var(--var-large-bg);\\n      display: flex;\\n      flex-direction: column; }\\n      aside div.glyphList div.glyph.active label {\\n        background: var(--var-glist-activeLabel);\\n        color: #fff; }\\n      aside div.glyphList div.glyph label {\\n        background: var(--var-glist-label);\\n        font-size: 9pt;\\n        font-weight: 500;\\n        text-align: center;\\n        white-space: nowrap;\\n        text-overflow: ellipsis;\\n        padding: 2px;\\n        overflow: hidden; }\\n      aside div.glyphList div.glyph canvas {\\n        width: 100%;\\n        height: auto; }\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/typeedit/styles/app/panel.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,eAAe;EACf,MAAM;EACN,QAAQ;EACR,SAAS;EACT,gBAAgB;EAChB,YAAY;EACZ,sBAAsB;EAEtB,2CAA2C;EAE3C,aAAa;EACb,sBAAsB,EAAA;EAZ1B;IAeQ,+BAA+B;IAE/B,aAAa;IACb,uBAAuB,EAAA;IAlB/B;MAqBY,uBAAuB;MACvB,yBAAyB;MAEzB,oBAAoB;MACpB,eAAe;MACf,gBAAgB;MAEhB,iBAAiB;MACjB,YAAY;MACZ,mBAAmB;MACnB,aAAa,EAAA;MA/BzB;QAkCgB,iDAEC,EAAA;MApCjB;QAwCgB,mCAAmC,EAAA;MAxCnD;QA4CgB,oCAAoC,EAAA;MA5CpD;QAgDgB,gCAAgC;QAChC,6CAA6C,EAAA;EAjD7D;IAuDQ,SAAS;IAET,YAAY;IACZ,kBAAkB,EAAA;EA1D1B;IA8DQ,aAAa,EAAA;EA9DrB;IAkEQ,+BAA+B;IAE/B,aAAa;IACb,qCAAqC;IACrC,QAAQ,EAAA;IAtEhB;MAyEY,eAAe;MAEf,+BAA+B;MAE/B,aAAa;MACb,sBAAsB,EAAA;MA9ElC;QAiFgB,wCAAwC;QACxC,WAAW,EAAA;MAlF3B;QAsFgB,kCAAkC;QAElC,cAAc;QACd,gBAAgB;QAChB,kBAAkB;QAClB,mBAAmB;QACnB,uBAAuB;QAEvB,YAAY;QAEZ,gBAAgB,EAAA;MAhGhC;QAoGgB,WAAW;QACX,YAAY,EAAA\",\"sourcesContent\":[\"aside {\\r\\n    position: fixed;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    min-width: 320px;\\r\\n    width: 320px;\\r\\n    box-sizing: border-box;\\r\\n\\r\\n    border-left: 1px solid var(--var-panel-sep);\\r\\n    \\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n\\r\\n    nav {\\r\\n        background: var(--var-panel-bg);\\r\\n\\r\\n        display: flex;\\r\\n        justify-content: center;\\r\\n\\r\\n        button {\\r\\n            background: transparent;\\r\\n            color: var(--var-text-fg);\\r\\n\\r\\n            font-family: \\\"Inter\\\";\\r\\n            font-size: 10pt;\\r\\n            font-weight: 400;\\r\\n\\r\\n            padding: 7px 20px;\\r\\n            border: none;\\r\\n            border-bottom: none;\\r\\n            outline: none;\\r\\n\\r\\n            &.tool {\\r\\n                background: linear-gradient(\\r\\n                    transparent, rgb(41, 56, 68)\\r\\n                );\\r\\n            }\\r\\n    \\r\\n            &:hover {\\r\\n                background: var(--var-button-hover);\\r\\n            }\\r\\n    \\r\\n            &:active {\\r\\n                background: var(--var-button-active);\\r\\n            }\\r\\n\\r\\n            &.active {\\r\\n                background: var(--var-panel-sep);\\r\\n                box-shadow: inset 0px -2px var(--var-text-fg);\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    div.listContainer {\\r\\n        height: 0; // WTF???\\r\\n\\r\\n        flex-grow: 1;\\r\\n        overflow-y: scroll;\\r\\n    }\\r\\n\\r\\n    div.panelContents:not(.active) {\\r\\n        display: none;\\r\\n    }\\r\\n\\r\\n    div.glyphList {\\r\\n        background: var(--var-panel-bg);\\r\\n\\r\\n        display: grid;\\r\\n        grid-template-columns: repeat(4, 1fr);\\r\\n        gap: 1px;\\r\\n\\r\\n        div.glyph {\\r\\n            max-width: 75px;\\r\\n\\r\\n            background: var(--var-large-bg);\\r\\n\\r\\n            display: flex;\\r\\n            flex-direction: column;\\r\\n\\r\\n            &.active label {\\r\\n                background: var(--var-glist-activeLabel);\\r\\n                color: #fff;\\r\\n            }\\r\\n\\r\\n            label {\\r\\n                background: var(--var-glist-label);\\r\\n\\r\\n                font-size: 9pt;\\r\\n                font-weight: 500;\\r\\n                text-align: center;\\r\\n                white-space: nowrap;\\r\\n                text-overflow: ellipsis;\\r\\n                \\r\\n                padding: 2px;\\r\\n\\r\\n                overflow: hidden;\\r\\n            }\\r\\n\\r\\n            canvas {\\r\\n                width: 100%;\\r\\n                height: auto;\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"article.welcome {\\n  display: flex;\\n  justify-content: center;\\n  align-items: flex-start; }\\n  article.welcome > div {\\n    width: 350px;\\n    height: calc(100vh - 80px);\\n    margin: 60px;\\n    display: flex;\\n    flex-direction: column; }\\n    article.welcome > div div.recentFiles {\\n      flex-grow: 1;\\n      overflow-y: auto; }\\n    article.welcome > div div.buttons {\\n      display: grid;\\n      grid-template-columns: repeat(2, 1fr);\\n      gap: 2px; }\\n    article.welcome > div h1 {\\n      font-size: 40pt;\\n      line-height: 1;\\n      margin: 0;\\n      text-align: center; }\\n    article.welcome > div h3 {\\n      font-size: 14pt;\\n      font-weight: 400;\\n      margin: 0px 0px 24px 0px;\\n      text-align: center; }\\n    article.welcome > div h2 {\\n      font-weight: 400;\\n      margin-bottom: 8px; }\\n    article.welcome > div button {\\n      width: 100%;\\n      background: var(--var-panel-bg);\\n      color: var(--var-text-fg);\\n      font-family: \\\"Inter\\\";\\n      border: none;\\n      outline: none;\\n      padding: 7px 8px;\\n      border: 1px solid var(--var-panel-sep);\\n      border-radius: 4px;\\n      margin-bottom: 2px;\\n      display: flex;\\n      align-items: center;\\n      justify-content: center; }\\n      article.welcome > div button.recent {\\n        flex-direction: column;\\n        justify-content: flex-start; }\\n      article.welcome > div button label.name {\\n        font-size: 12pt;\\n        font-weight: 500; }\\n      article.welcome > div button label.path {\\n        opacity: 0.6; }\\n      article.welcome > div button:hover {\\n        background: var(--var-button-hover); }\\n      article.welcome > div button:active {\\n        background: var(--var-button-active); }\\n      article.welcome > div button img {\\n        margin-right: 8px; }\\n        article.welcome > div button img.preview {\\n          width: 332px;\\n          height: auto;\\n          margin: 0; }\\n  article.welcome canvas.previewGenerator {\\n    position: absolute;\\n    pointer-events: none;\\n    opacity: 0; }\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://src/typeedit/styles/welcome.scss\"],\"names\":[],\"mappings\":\"AAAA;EACI,aAAa;EACb,uBAAuB;EACvB,uBAAuB,EAAA;EAH3B;IAMQ,YAAY;IACZ,0BAA0B;IAE1B,YAAY;IAEZ,aAAa;IACb,sBAAsB,EAAA;IAZ9B;MAeY,YAAY;MACZ,gBAAgB,EAAA;IAhB5B;MAoBY,aAAa;MACb,qCAAqC;MACrC,QAAQ,EAAA;IAtBpB;MA0BY,eAAe;MACf,cAAc;MAEd,SAAS;MAET,kBAAkB,EAAA;IA/B9B;MAmCY,eAAe;MACf,gBAAgB;MAEhB,wBAAwB;MAExB,kBAAkB,EAAA;IAxC9B;MA4CY,gBAAgB;MAEhB,kBAAkB,EAAA;IA9C9B;MAkDY,WAAW;MAEX,+BAA+B;MAC/B,yBAAyB;MAEzB,oBAAoB;MAEpB,YAAY;MACZ,aAAa;MACb,gBAAgB;MAChB,sCAAsC;MACtC,kBAAkB;MAClB,kBAAkB;MAElB,aAAa;MACb,mBAAmB;MACnB,uBAAuB,EAAA;MAlEnC;QAqEgB,sBAAsB;QACtB,2BAA2B,EAAA;MAtE3C;QA0EgB,eAAe;QACf,gBAAgB,EAAA;MA3EhC;QA+EgB,YAAY,EAAA;MA/E5B;QAmFgB,mCAAmC,EAAA;MAnFnD;QAuFgB,oCAAoC,EAAA;MAvFpD;QA2FgB,iBAAiB,EAAA;QA3FjC;UA8FoB,YAAY;UACZ,YAAY;UAEZ,SAAS,EAAA;EAjG7B;IAwGQ,kBAAkB;IAClB,oBAAoB;IACpB,UAAU,EAAA\",\"sourcesContent\":[\"article.welcome {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    align-items: flex-start;\\r\\n\\r\\n    & > div {\\r\\n        width: 350px;\\r\\n        height: calc(100vh - 80px);\\r\\n\\r\\n        margin: 60px;\\r\\n\\r\\n        display: flex;\\r\\n        flex-direction: column;\\r\\n\\r\\n        div.recentFiles {\\r\\n            flex-grow: 1;\\r\\n            overflow-y: auto;\\r\\n        }\\r\\n\\r\\n        div.buttons {\\r\\n            display: grid;\\r\\n            grid-template-columns: repeat(2, 1fr);\\r\\n            gap: 2px;\\r\\n        }\\r\\n\\r\\n        h1 {\\r\\n            font-size: 40pt;\\r\\n            line-height: 1;\\r\\n\\r\\n            margin: 0;\\r\\n\\r\\n            text-align: center;\\r\\n        }\\r\\n\\r\\n        h3 {\\r\\n            font-size: 14pt;\\r\\n            font-weight: 400;\\r\\n\\r\\n            margin: 0px 0px 24px 0px;\\r\\n\\r\\n            text-align: center;\\r\\n        }\\r\\n\\r\\n        h2 {\\r\\n            font-weight: 400;\\r\\n            \\r\\n            margin-bottom: 8px;\\r\\n        }\\r\\n\\r\\n        button {\\r\\n            width: 100%;\\r\\n\\r\\n            background: var(--var-panel-bg);\\r\\n            color: var(--var-text-fg);\\r\\n\\r\\n            font-family: \\\"Inter\\\";\\r\\n\\r\\n            border: none;\\r\\n            outline: none;\\r\\n            padding: 7px 8px;\\r\\n            border: 1px solid var(--var-panel-sep);\\r\\n            border-radius: 4px;\\r\\n            margin-bottom: 2px;\\r\\n\\r\\n            display: flex;\\r\\n            align-items: center;\\r\\n            justify-content: center;\\r\\n\\r\\n            &.recent {\\r\\n                flex-direction: column;\\r\\n                justify-content: flex-start;\\r\\n            }\\r\\n\\r\\n            label.name {\\r\\n                font-size: 12pt;\\r\\n                font-weight: 500;\\r\\n            }\\r\\n\\r\\n            label.path {\\r\\n                opacity: 0.6;\\r\\n            }\\r\\n    \\r\\n            &:hover {\\r\\n                background: var(--var-button-hover);\\r\\n            }\\r\\n        \\r\\n            &:active {\\r\\n                background: var(--var-button-active);\\r\\n            }\\r\\n\\r\\n            img {\\r\\n                margin-right: 8px;\\r\\n\\r\\n                &.preview {\\r\\n                    width: 332px;\\r\\n                    height: auto;\\r\\n\\r\\n                    margin: 0;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    canvas.previewGenerator {\\r\\n        position: absolute;\\r\\n        pointer-events: none;\\r\\n        opacity: 0;\\r\\n    }\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && btoa) {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","import \"./typeedit/styles/app.scss\"\r\nimport \"./typeedit/styles/app/main.scss\"\r\nimport \"./typeedit/styles/app/panel.scss\"\r\nimport \"./typeedit/styles/app/editor.scss\"\r\n\r\nimport \"./typeedit/styles/welcome.scss\"\r\n\r\nimport app, { currentFont } from \"./typeedit/app\"\r\nimport paper from \"paper\"\r\nimport { remote } from \"electron\"\r\nimport { basename, extname } from \"path\"\r\nimport { importFont_opentype } from \"./typeedit/io/opentype.js/import\"\r\nimport { Font } from \"./typeedit/font/font\"\r\nimport { exportFont_opentype } from \"./typeedit/io/opentype.js/export\"\r\nimport { existsSync, readFileSync, writeFileSync } from \"fs\"\r\nimport { setOtfccPath } from \"./typeedit/io/otfcc/import\"\r\nimport { createFontPreview } from \"./typeedit/utils/preview\"\r\nimport { FTEX1 } from \"./typeedit/io/ftex/ftex\"\r\nimport { SmartBuffer } from \"smart-buffer\"\r\nimport { openFont, saveFont } from \"./typeedit/io/io\"\r\nimport { prepareFontSettings, prepareTabbedPanel } from \"./typeedit/ui/panel\"\r\n\r\nconsole.log(remote)\r\n\r\nconst scope = new paper.PaperScope()\r\nscope.install(window)\r\nscope.setup(new paper.Size(1000, 1000))\r\n\r\ntype RecentFile = {\r\n    filePath: string\r\n    fontName: string\r\n    thumbnail: string\r\n}\r\n\r\nconst recentFiles: RecentFile[] = JSON.parse(\r\n    localStorage.getItem(\"recentFiles\")\r\n) ?? []\r\n\r\nif (existsSync(\"./otfcc_test\")) {\r\n    // There are otfcc binaries\r\n    // NOTE: still testing this part, so they aren't included in the repo\r\n    setOtfccPath(\"./otfcc_test\")\r\n}\r\n\r\nrecentFiles.forEach(\r\n    file => {\r\n        const btn = document.createElement(\"button\")\r\n        btn.classList.add(\"recent\")\r\n\r\n        const fontPreview = document.createElement(\"img\")\r\n        fontPreview.classList.add(\"preview\")\r\n        fontPreview.src = file.thumbnail\r\n        btn.appendChild(fontPreview)\r\n\r\n        const fontNameLabel = document.createElement(\"label\")\r\n        fontNameLabel.classList.add(\"name\")\r\n        fontNameLabel.textContent = file.fontName\r\n        btn.appendChild(fontNameLabel)\r\n\r\n        const filePathLabel = document.createElement(\"label\")\r\n        filePathLabel.classList.add(\"path\")\r\n        filePathLabel.textContent = basename(file.filePath)\r\n        btn.appendChild(filePathLabel)\r\n\r\n        btn.addEventListener(\r\n            \"click\", () => {\r\n                const font = openFont(file.filePath)\r\n                \r\n                const welcome = document.querySelector(\"article.welcome\") as HTMLDivElement\r\n                welcome.style.display = \"none\"\r\n                    \r\n                app(font)\r\n\r\n                const index = recentFiles.findIndex(\r\n                    p => p.filePath === file.filePath\r\n                )\r\n                if (index >= 0) {\r\n                    const item = recentFiles[index]\r\n                    recentFiles.splice(index, 1)\r\n                    recentFiles.unshift(item)\r\n\r\n                    localStorage.setItem(\r\n                        \"recentFiles\",\r\n                        JSON.stringify(\r\n                            recentFiles.slice(0, 8)\r\n                        )\r\n                    )\r\n                }\r\n            }\r\n        )\r\n\r\n        document.querySelector(\"div.recentFiles\").appendChild(btn)\r\n    }\r\n)\r\n\r\ndocument.querySelectorAll(\"button.newFont\").forEach(\r\n    btn => btn.addEventListener(\r\n        \"click\", () => {\r\n            const welcome = document.querySelector(\"article.welcome\") as HTMLDivElement\r\n            welcome.style.display = \"none\"\r\n\r\n            app(Font.createBlank())\r\n        }\r\n    )\r\n)\r\n\r\ndocument.querySelectorAll(\"button.openFont\").forEach(\r\n    btn => btn.addEventListener(\r\n        \"click\", () => {\r\n            remote.dialog.showOpenDialog(\r\n                remote.getCurrentWindow(),\r\n                {\r\n                    filters: [\r\n                        {\r\n                            name: \"Supported fonts\",\r\n                            extensions: [\r\n                                \"ftex\", \"otf\", \"ttf\"\r\n                            ]\r\n                        },\r\n                        {\r\n                            name: \"FTEX project file\",\r\n                            extensions: [\"ftex\"]\r\n                        },\r\n                        {\r\n                            name: \"OpenType fonts\",\r\n                            extensions: [\"otf\"]\r\n                        },\r\n                        {\r\n                            name: \"TrueType fonts\",\r\n                            extensions: [\"ttf\"]\r\n                        }\r\n                    ],\r\n                    properties: [\"openFile\"]\r\n                }\r\n            ).then(result => {\r\n                if (\r\n                    result.canceled ||\r\n                    result.filePaths.length !== 1\r\n                ) return\r\n\r\n                try {\r\n                    const font = openFont(result.filePaths[0])\r\n\r\n                    const welcome = document.querySelector(\"article.welcome\") as HTMLDivElement\r\n                    welcome.style.display = \"none\"\r\n\r\n                    app(font)\r\n\r\n                    const index = recentFiles.findIndex(\r\n                        p => p.filePath === result.filePaths[0]\r\n                    )\r\n                    if (index >= 0) recentFiles.splice(index, 1)\r\n\r\n                    recentFiles.unshift(\r\n                        {\r\n                            filePath: result.filePaths[0],\r\n                            fontName: font.info.fontFamily + \" \" +\r\n                                      font.info.fontSubfamily,\r\n                            thumbnail: createFontPreview(font)\r\n                        }\r\n                    )\r\n                    localStorage.setItem(\r\n                        \"recentFiles\",\r\n                        JSON.stringify(\r\n                            recentFiles.slice(0, 8)\r\n                        )\r\n                    )\r\n                } catch(e) {\r\n                    // Well, error!\r\n                    console.error(e)\r\n                    alert(\"Couldn't load the font file.\")\r\n                }\r\n            })\r\n        }\r\n    )\r\n)\r\n\r\ndocument.querySelectorAll(\"button.saveFont\").forEach(\r\n    btn => btn.addEventListener(\r\n        \"click\", () => {\r\n            remote.dialog.showSaveDialog(\r\n                remote.getCurrentWindow(),\r\n                {\r\n                    filters: [\r\n                        {\r\n                            name: \"FTEX project file\",\r\n                            extensions: [\"ftex\"]\r\n                        },\r\n                        {\r\n                            name: \"OpenType fonts\",\r\n                            extensions: [\"otf\"]\r\n                        },\r\n                        {\r\n                            name: \"TrueType fonts\",\r\n                            extensions: [\"ttf\"]\r\n                        }\r\n                    ],\r\n                    defaultPath: currentFont.info.fontFamily +\r\n                                 \"-\" + currentFont.info.fontSubfamily\r\n                }\r\n            ).then(result => {\r\n                if (result.canceled) return\r\n\r\n                saveFont(currentFont, result.filePath)\r\n            })\r\n        }\r\n    )\r\n)\r\n\r\ndocument.body.addEventListener(\"keydown\", (e) => {\r\n    if (e.code === \"KeyZ\" && e.ctrlKey) {\r\n        e.preventDefault()\r\n    }\r\n})\r\n\r\ndocument.addEventListener(\"drop\", (e) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n\r\n    if (!e.dataTransfer.files.length) return\r\n\r\n    try {\r\n        const path = e.dataTransfer.files.item(0).path\r\n        const font = openFont(path)\r\n        if (!font) return\r\n        \r\n        const welcome = document.querySelector(\"article.welcome\") as HTMLDivElement\r\n        welcome.style.display = \"none\"\r\n\r\n        app(font)\r\n\r\n        const index = recentFiles.findIndex(\r\n            p => p.filePath === path\r\n        )\r\n        if (index >= 0) recentFiles.splice(index, 1)\r\n\r\n        recentFiles.unshift(\r\n            {\r\n                filePath: path,\r\n                fontName: font.info.fontFamily + \" \" +\r\n                          font.info.fontSubfamily,\r\n                thumbnail: createFontPreview(font)\r\n            }\r\n        )\r\n        localStorage.setItem(\r\n            \"recentFiles\",\r\n            JSON.stringify(\r\n                recentFiles.slice(0, 8)\r\n            )\r\n        )\r\n    } catch (e) {\r\n        // Well, error!\r\n        console.error(e)\r\n        alert(\"Couldn't load the font file.\")\r\n    }\r\n})\r\n\r\ndocument.addEventListener(\"dragover\", (e) => { \r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n}); \r\n\r\nprepareTabbedPanel()\r\n\r\n// load(\"test/Inter-Regular.otf\").then(\r\n//     (font) => {\r\n//         app(font)\r\n//     }\r\n// )","import { BezierPenTool } from \"./viewport/tools/bezierPen\"\r\nimport { HandleTool } from \"./viewport/tools/handle\"\r\nimport { GlyphContext } from \"./viewport/context/glyph\"\r\nimport { updateSubactions } from \"./ui/actionbar\"\r\nimport { setupViewport } from \"./ui/viewport\"\r\nimport { prepareGlyphBar } from \"./ui/glyphBar\"\r\nimport { prepareGlyphList } from \"./ui/glyphList\"\r\nimport { ITool, ToolSubAction } from \"./viewport/tools/tool\"\r\nimport { undo, redo } from \"./undo/history\"\r\nimport { prepareToolbar, setActiveTool } from \"./ui/toolbar\"\r\nimport { Font } from \"./font/font\"\r\nimport { RectangleTool } from \"./viewport/tools/rectangle\"\r\nimport { EllipseTool } from \"./viewport/tools/ellipse\"\r\nimport { addFontSettingsEvents, prepareFontSettings } from \"./ui/panel\"\r\n\r\nexport let currentFont: Font = null\r\n\r\nconst globalSubActions: ToolSubAction[] = [\r\n    {\r\n        name: \"Undo\",\r\n        icon: \"undo\",\r\n        accelerator: \"^KeyZ\",\r\n        handler: () => {\r\n            undo()\r\n        }\r\n    },\r\n    {\r\n        name: \"Redo\",\r\n        icon: \"redo\",\r\n        accelerator: \"^+KeyZ\",\r\n        handler: () => {\r\n            redo()\r\n        }\r\n    },\r\n]\r\n\r\nconst globalTools = [\r\n    new HandleTool(),\r\n    new BezierPenTool(),\r\n    new RectangleTool(),\r\n    new EllipseTool()\r\n]\r\n\r\nlet currentKeybCallback: (e: KeyboardEvent) => void = null\r\n\r\nexport default (font: Font) => {\r\n    currentFont = font\r\n\r\n    document.title = `${font.info.fontFamily} - FTE`\r\n    prepareGlyphList(font)\r\n\r\n    prepareFontSettings()\r\n    addFontSettingsEvents()\r\n\r\n    const context = new GlyphContext(\r\n        \"ABC\".split(\"\").map(\r\n            chr => font.glyphs.find(g => g.codePoint === chr.codePointAt(0))\r\n        ), 0\r\n    )\r\n\r\n    const viewport = setupViewport(context)\r\n    viewport.setTool(new HandleTool())\r\n    updateSubactions(viewport, [globalSubActions, ...viewport.tool.subactions.map(s => s.subactions)])\r\n    \r\n    prepareToolbar(\r\n        globalTools,\r\n        globalTools[0],\r\n        (tool: ITool) => {\r\n            viewport.setTool(tool)\r\n            updateSubactions(\r\n                viewport,\r\n                [globalSubActions, ...tool.subactions.map(s => s.subactions)]\r\n            )\r\n        }\r\n    )\r\n\r\n    prepareGlyphBar(viewport)\r\n\r\n    viewport.updateViewportSize(false)\r\n    viewport.co.translate(\r\n        (viewport.domCanvas.width - context.glyph.metrics.rightBearing) / 2,\r\n        (viewport.domCanvas.height - 512) / 2\r\n    )\r\n    viewport.render()\r\n\r\n    font.on(\"settingChanged\", () => viewport.render())\r\n\r\n    if (currentKeybCallback)\r\n        window.removeEventListener(\"keyup\", currentKeybCallback)\r\n\r\n    currentKeybCallback = (e: KeyboardEvent) => {\r\n        if (document.activeElement !== document.body) return // for now\r\n\r\n        let accelString = e.code\r\n        if (e.shiftKey) accelString = \"+\" + accelString\r\n        if (e.ctrlKey) accelString = \"^\" + accelString\r\n\r\n        for (let action of [\r\n            globalTools,\r\n            globalSubActions, ...viewport.tool.subactions.map(s => s.subactions)\r\n        ].flat()) {\r\n            if (action.accelerator === accelString) {\r\n                if (\"handler\" in action) {\r\n                    action.handler()\r\n                    viewport.render()\r\n                    if (viewport.context instanceof GlyphContext)\r\n                        viewport.context.glyph.emit(\"modified\")\r\n                } else {\r\n                    viewport.setTool(action)\r\n                    updateSubactions(\r\n                        viewport,\r\n                        [globalSubActions, ...action.subactions.map(s => s.subactions)]\r\n                    )\r\n                    setActiveTool(globalTools.indexOf(action))\r\n                }\r\n                e.preventDefault()\r\n                return false\r\n            }\r\n        }\r\n    }\r\n    window.addEventListener(\"keyup\", currentKeybCallback)\r\n}","import { Glyph } from \"./glyph\"\r\nimport { EventEmitter } from \"events\"\r\nimport { createFontSettings, FontSettings } from \"../settings/settings\"\r\n\r\nexport type FontMetrics = {\r\n    ascender: number,\r\n    descender: number,\r\n    xHeight: number\r\n}\r\n\r\nexport type FontInfo = {\r\n    copyright: string,\r\n    description: string,\r\n    designer: string,\r\n    designerURL: string,\r\n    fontFamily: string,\r\n    fontSubfamily: string,\r\n    fullName: string,\r\n    license: string,\r\n    licenseURL: string,\r\n    manufacturer: string,\r\n    manufacturerURL: string,\r\n    postScriptName: string,\r\n    uniqueID: string,\r\n    version: string,\r\n    trademark: string,\r\n    compatibleFullName: string\r\n}\r\n\r\nexport type FontColors = {\r\n    red: number,\r\n    green: number,\r\n    blue: number\r\n}\r\n\r\nexport class Font extends EventEmitter {\r\n    public palette: FontColors[] = []\r\n\r\n    private _fontSettings: Partial<FontSettings> = {}\r\n    public settings: FontSettings\r\n\r\n    constructor(\r\n        public info: Partial<FontInfo>,\r\n        public metrics: FontMetrics,\r\n        public glyphs: Glyph[]\r\n    ) {\r\n        super()\r\n\r\n        this.settings = createFontSettings(this, this._fontSettings)\r\n\r\n        this.info = Object.assign(\r\n            {\r\n                copyright: \"\",\r\n                description: \"\",\r\n                designer: \"\",\r\n                designerURL: \"\",\r\n                fontFamily: \"\",\r\n                fontSubfamily: \"\",\r\n                fullName: \"\",\r\n                license: \"\",\r\n                licenseURL: \"\",\r\n                manufacturer: \"\",\r\n                manufacturerURL: \"\",\r\n                postScriptName: \"\",\r\n                uniqueID: \"\",\r\n                version: \"\",\r\n                trademark: \"\",\r\n                compatibleFullName: \"\"\r\n            }, this.info\r\n        )\r\n    }\r\n\r\n    static createBlank() {\r\n        // Just the base Latin alphanumeric for now\r\n        const baseCharacterSet = \" 0123456789-=_+!@#$%^&*(){}[]\\\\\\/,.<>?;':\\\"~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\"\r\n        const specialNames: {\r\n            [key: string]: string\r\n        } = {\r\n            \" \": \"space\",\r\n            \"'\": \"quote\",\r\n            \"\\\"\": \"dblquote\",\r\n            \"!\": \"exclam\",\r\n            \"@\": \"at\",\r\n            \"#\": \"hash\",\r\n            \"$\": \"dollar\",\r\n            \"%\": \"percent\",\r\n            \"^\": \"caret\",\r\n            \"&\": \"ampersand\",\r\n            \"*\": \"asterisk\"\r\n        }\r\n\r\n        const font = new Font(\r\n            {\r\n                fontFamily: \"New font\",\r\n                fontSubfamily: \"Regular\"\r\n            },\r\n            {\r\n                ascender: -96,\r\n                descender: 512 + 96,\r\n                xHeight: 196\r\n            },\r\n            []\r\n        )\r\n        font.addGlyph(\r\n            new Glyph(\r\n                font, \".notdef\", null,\r\n                {\r\n                    leftBearing: 0,\r\n                    rightBearing: 320\r\n                },\r\n                []\r\n            ),\r\n            ...baseCharacterSet.split(\"\").map(\r\n                char => {\r\n                    const name = (char in specialNames) ? specialNames[char] : char\r\n\r\n                    return new Glyph(\r\n                        font, name, char.codePointAt(0),\r\n                        {\r\n                            leftBearing: 0,\r\n                            rightBearing: 320\r\n                        },\r\n                        []\r\n                    )\r\n                }\r\n            )\r\n        )\r\n\r\n        return font\r\n    }\r\n\r\n    addGlyph(...glyphs: Glyph[]) {\r\n        this.glyphs.push(...glyphs)\r\n    }\r\n}","import { EventEmitter } from \"events\"\r\nimport { BezierCurve } from \"../geometry/bezier/curve\"\r\nimport { Font } from \"./font\"\r\n\r\nexport type GlyphMetrics = {\r\n    leftBearing: number,\r\n    rightBearing: number\r\n}\r\n\r\nexport class Glyph extends EventEmitter {\r\n    public finalBeziers: BezierCurve[] = []\r\n\r\n    constructor(\r\n        public font: Font,\r\n        public name: string,\r\n        public codePoint: number,\r\n        public metrics: GlyphMetrics,\r\n        public beziers: BezierCurve[]\r\n    ) {\r\n        super()\r\n\r\n        if (!name) {\r\n            this.name = codePoint ?\r\n                   `uni${codePoint.toString(16).toUpperCase().padStart(4, \"0\")}` :\r\n                   \".notdef\"\r\n        }\r\n        \r\n        this.beziers.forEach(b => b.glyph = this)\r\n        this.finalBeziers = beziers // for now\r\n\r\n        this.on(\"modified\", () => {\r\n            this.font.emit(\"glyphModified\", this)\r\n        })\r\n    }\r\n\r\n    get comparableCodePoint() {\r\n        if (this.name === \".notdef\") return -2\r\n        if (this.name === \".null\") return -1\r\n        return this.codePoint ?? Infinity\r\n    }\r\n\r\n    updateBeziers() {\r\n        // Nothing for now\r\n        // TODO: modifiers\r\n        this.finalBeziers = this.beziers\r\n    }\r\n}","import { EventEmitter } from \"events\"\r\nimport { Glyph } from \"../../font/glyph\"\r\nimport { BezierPoint } from \"./point\"\r\nimport paper from \"paper\"\r\nimport { Point } from \"../point\"\r\nimport { lerp } from \"../../utils/lerp\"\r\n\r\nexport class BezierCurve extends EventEmitter {\r\n    public points: BezierPoint[] = []\r\n    public closed = true\r\n\r\n    constructor(\r\n        public glyph?: Glyph\r\n    ) {\r\n        super()\r\n\r\n        this.on(\"modified\", () => {\r\n            if (this.glyph) this.glyph.emit(\"modified\")\r\n        })\r\n    }\r\n\r\n    addPoint(point: BezierPoint) {\r\n        point.curve = this\r\n        this.points.push(point)\r\n        this.emit(\"modified\")\r\n        this.emit(\"newPoint\", point)\r\n    }\r\n\r\n    lineTo(x: number, y: number) {\r\n        this.addPoint(\r\n            new BezierPoint(\r\n                new Point(x, y),\r\n                new Point(x, y),\r\n                new Point(x, y)\r\n            )\r\n        )\r\n    }\r\n\r\n    cubicCurveTo(\r\n        c1x: number, c1y: number,\r\n        c2x: number, c2y: number,\r\n        x: number, y: number\r\n    ) {\r\n        if (!this.points.length) return\r\n\r\n        const prev = this.points[this.points.length - 1]\r\n\r\n        prev.after.x = c1x\r\n        prev.after.y = c1y\r\n\r\n        this.addPoint(\r\n            new BezierPoint(\r\n                new Point(x, y),\r\n                new Point(c2x, c2y),\r\n                new Point(x, y)\r\n            )\r\n        )\r\n    }\r\n\r\n    quadraticCurveTo(\r\n        cx: number, cy: number,\r\n        x: number, y: number\r\n    ) {\r\n        if (!this.points.length) return\r\n\r\n        const prev = this.points[this.points.length - 1]\r\n\r\n        prev.after.x = lerp(2 / 3, prev.base.x, cx)\r\n        prev.after.y = lerp(2 / 3, prev.base.y, cy)\r\n\r\n        this.addPoint(\r\n            new BezierPoint(\r\n                new Point(x, y),\r\n                new Point(\r\n                    lerp(1 / 3, cx, x),\r\n                    lerp(1 / 3, cy, y)\r\n                ),\r\n                new Point(x, y)\r\n            )\r\n        )\r\n    }\r\n\r\n    // see: https://www.element84.com/blog/determining-the-winding-of-a-polygon-given-as-a-set-of-ordered-points\r\n    get clockwise() {\r\n        let sum = 0\r\n\r\n        for (let i = 0; i < this.points.length; i++) {\r\n            const point = this.points[i].base\r\n            const next = this.points[\r\n                (i + 1) % this.points.length\r\n            ].base\r\n\r\n            sum += (next.x - point.x) * (next.y - point.y)\r\n        }\r\n\r\n        return sum < 0 // inverted Y axis!\r\n    }\r\n\r\n    reverse() {\r\n        this.points.forEach(\r\n            p => p.reverse()\r\n        )\r\n        this.points = this.points.reverse()\r\n    }\r\n\r\n    static getPath2D(beziers: BezierCurve[]) {\r\n        const path = new Path2D()\r\n\r\n        for (let bezier of beziers) {\r\n            for (let i = 0; i < bezier.points.length; i++) {\r\n                const p1 = bezier.points[i]\r\n                const p2 = bezier.points[(i + 1) % bezier.points.length]\r\n                if (i === 0)\r\n                    path.moveTo(p1.base.x, p1.base.y)\r\n    \r\n                path.bezierCurveTo(\r\n                    p1.after.x, p1.after.y,\r\n                    p2.before.x, p2.before.y,\r\n                    p2.base.x, p2.base.y\r\n                )\r\n            }\r\n        }\r\n\r\n        return path\r\n    }\r\n\r\n    getPaperPath(): paper.Path {\r\n        const path = new paper.Path()\r\n        if (!this.points.length) return path\r\n        \r\n        const first = this.points[0].base\r\n        path.moveTo(new paper.Point(first.x, first.y))\r\n\r\n        for (let i = 0; i < this.points.length; i++) {\r\n            const pt = this.points[i]\r\n            const next = this.points[\r\n                (i + 1) % this.points.length\r\n            ]\r\n\r\n            const c1 = pt.after\r\n            const c2 = next.before\r\n            const b = next.base\r\n\r\n            path.cubicCurveTo(\r\n                new paper.Point(c1.x, c1.y),\r\n                new paper.Point(c2.x, c2.y),\r\n                new paper.Point(b.x, b.y)\r\n            )\r\n        }\r\n\r\n        path.closePath()\r\n\r\n        return path\r\n    }\r\n    \r\n    static fromPaperPath(path: paper.Path): BezierCurve {\r\n        const curve = new BezierCurve()\r\n\r\n        path.segments.forEach(\r\n            seg => curve.addPoint(\r\n                new BezierPoint(\r\n                    new Point(seg.point.x, seg.point.y),\r\n                    new Point(\r\n                        seg.point.x + seg.handleIn.x,\r\n                        seg.point.y + seg.handleIn.y\r\n                    ),\r\n                    new Point(\r\n                        seg.point.x + seg.handleOut.x,\r\n                        seg.point.y + seg.handleOut.y\r\n                    )\r\n                )\r\n            )\r\n        )\r\n\r\n        return curve\r\n    }\r\n\r\n    static fromPaperPathItem(item: paper.PathItem): BezierCurve[] {\r\n        if (item instanceof paper.Path)\r\n            return [BezierCurve.fromPaperPath(item)]\r\n        else if (item instanceof paper.CompoundPath)\r\n            return item.children.map(\r\n                ch => {\r\n                    if (ch instanceof paper.Path)\r\n                        return BezierCurve.fromPaperPath(ch)\r\n                    return null\r\n                }\r\n            ).filter(c => c)\r\n        \r\n        return []\r\n    }\r\n}\r\n\r\n","import { EventEmitter } from \"events\"\r\nimport { Point } from \"../point\"\r\nimport { BezierCurve } from \"./curve\"\r\n\r\nexport enum BezierPointType {\r\n    free, auto, sharp\r\n}\r\n\r\nexport class BezierPoint extends EventEmitter {\r\n    public curve: BezierCurve = null\r\n\r\n    constructor(\r\n        public base: Point,\r\n        public before: Point,\r\n        public after: Point,\r\n        public type: BezierPointType = BezierPointType.auto\r\n    ) {\r\n        super()\r\n        \r\n        this.on(\"modified\", () => {\r\n            if (this.curve) this.curve.emit(\"modified\")\r\n        })\r\n    }\r\n\r\n    reverse() {\r\n        const t = this.before\r\n        this.before = this.after\r\n        this.after = t\r\n    }\r\n\r\n    determineType() {\r\n        const radius1 = this.after.distance(this.base)\r\n        const radius2 = this.before.distance(this.base)\r\n\r\n        if (radius1 < 0.0001 && radius2 < 0.0001) {\r\n            this.type = BezierPointType.sharp\r\n            return\r\n        }\r\n\r\n        const angle1 = this.after.angle(this.base)\r\n        const angle2 = this.before.angle(this.base)\r\n\r\n        const angleDiff = Math.abs(angle1 - angle2)\r\n        const piDiff = angleDiff / Math.PI\r\n\r\n        if (Math.abs(piDiff - Math.round(piDiff)) < 0.0001)\r\n            this.type = BezierPointType.auto\r\n    }\r\n\r\n    movePoint(point: Point, dPos: Point) {\r\n        if (point === this.base) {\r\n            this.base.move(dPos.x, dPos.y)\r\n            this.before.move(dPos.x, dPos.y)\r\n            this.after.move(dPos.x, dPos.y)\r\n        } else {\r\n            const otherPoint = point === this.before ?\r\n                               this.after : this.before\r\n            \r\n            point.move(dPos.x, dPos.y)\r\n\r\n            if (this.type === BezierPointType.auto) {\r\n                const otherRadius = otherPoint.distance(this.base)\r\n                const angle = point.angle(this.base)\r\n\r\n                otherPoint.x = otherRadius * Math.cos(angle + Math.PI) + this.base.x\r\n                otherPoint.y = otherRadius * Math.sin(angle + Math.PI) + this.base.y\r\n            }\r\n        }\r\n\r\n        this.curve.emit(\"modified\")\r\n    }\r\n}","export class Point {\r\n    constructor(\r\n        public x = 0,\r\n        public y = 0\r\n    ) {}\r\n\r\n    move(dx: number, dy: number) {\r\n        this.x += dx\r\n        this.y += dy\r\n    }\r\n\r\n    distance(other: Point) {\r\n        return Math.hypot(\r\n            this.x - other.x,\r\n            this.y - other.y\r\n        )\r\n    }\r\n\r\n    angle(origin: Point) {\r\n        return Math.atan2(\r\n            this.y - origin.y,\r\n            this.x - origin.x\r\n        )\r\n    }\r\n\r\n    getDiff(last: Point) {\r\n        return new Point(\r\n            this.x - last.x,\r\n            this.y - last.y\r\n        )\r\n    }\r\n\r\n    copy(ref: Point) {\r\n        this.x = ref.x\r\n        this.y = ref.y\r\n    }\r\n}","import { SmartBuffer } from \"smart-buffer\"\r\nimport { deflateSync, inflateSync } from \"zlib\"\r\nimport { Font } from \"../../font/font\"\r\nimport { Glyph } from \"../../font/glyph\"\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\"\r\nimport { BezierPoint } from \"../../geometry/bezier/point\"\r\nimport { Point } from \"../../geometry/point\"\r\n\r\nconst fontInfoIndices = [\r\n    \"copyright\",\r\n    \"description\",\r\n    \"designer\",\r\n    \"designerURL\",\r\n    \"fontFamily\",\r\n    \"fontSubfamily\",\r\n    \"fullName\",\r\n    \"license\",\r\n    \"licenseURL\",\r\n    \"manufacturer\",\r\n    \"manufacturerURL\",\r\n    \"postScriptName\",\r\n    \"uniqueID\",\r\n    \"version\",\r\n    \"trademark\",\r\n    \"compatibleFullName\"\r\n]\r\n\r\ntype FMET = {\r\n    ascender: number,\r\n    descender: number,\r\n    xHeight: number\r\n}\r\n\r\ntype OUTLEntry = {\r\n    handles: {\r\n        type: number,\r\n        base: number[],\r\n        before: number[],\r\n        after: number[]\r\n    }[],\r\n    startIndices: number[]\r\n}\r\n\r\ntype GLPHEntry = {\r\n    codePoint: number,\r\n    name: string,\r\n    leftSide: number,\r\n    rightSide: number,\r\n    outlines: number[]\r\n}\r\n\r\nexport class FTEX1 {\r\n    protected ftexVersion = 1\r\n\r\n    protected fmet: FMET\r\n    \r\n    protected outl: OUTLEntry[] = []\r\n    protected glph: GLPHEntry[] = []\r\n    protected fnam: {\r\n        index: number,\r\n        name: string\r\n    }[] = []\r\n    protected defl: Buffer[] = []\r\n\r\n    get tableCount() {\r\n        let count = 0\r\n\r\n        if (this.fnam.length) count++\r\n        if (this.fmet) count++\r\n        if (this.outl.length) count++\r\n        if (this.glph.length) count++\r\n\r\n        return count\r\n    }\r\n\r\n    static fromFont(font: Font) {\r\n        const ftex = new FTEX1()\r\n\r\n        ftex.setFMET(font)\r\n        ftex.setGLPH(font)\r\n        ftex.setFNAM(font)\r\n\r\n        return ftex\r\n    }\r\n\r\n    getFont(): Font {\r\n        if (this.tableCount < 4) return null\r\n\r\n        const info: any = {}\r\n        this.fnam.forEach(\r\n            name => info[fontInfoIndices[name.index]] = name.name\r\n        )\r\n\r\n        const metrics = this.fmet\r\n\r\n        const font = new Font(info, metrics, [])\r\n\r\n        this.glph.forEach(\r\n            g => {\r\n                if (!g.outlines.length) return\r\n\r\n                font.addGlyph(\r\n                    new Glyph(\r\n                        font,\r\n                        g.name,\r\n                        (g.codePoint === 0) ? undefined : g.codePoint,\r\n                        {\r\n                            leftBearing: g.leftSide,\r\n                            rightBearing: g.rightSide\r\n                        },\r\n                        this.getCurvesFromOUTL(\r\n                            this.outl[g.outlines[0]]\r\n                        )\r\n                    )\r\n                )\r\n            }\r\n        )\r\n\r\n        return font\r\n    }\r\n\r\n    getCurvesFromOUTL(outl: OUTLEntry): BezierCurve[] {\r\n        return outl.startIndices.map(\r\n            (index, i) => {\r\n                const handles = (i === outl.startIndices.length - 1) ?\r\n                                outl.handles.slice(index) :\r\n                                outl.handles.slice(index, outl.startIndices[i + 1])\r\n                const curve = new BezierCurve()\r\n\r\n                handles.forEach(\r\n                    h => {\r\n                        const point = new BezierPoint(\r\n                            new Point(h.base[0], h.base[1]),\r\n                            new Point(h.before[0], h.before[1]),\r\n                            new Point(h.after[0], h.after[1])\r\n                        )\r\n                        point.type = h.type\r\n\r\n                        curve.addPoint(point)\r\n                    }\r\n                )\r\n                \r\n                return curve\r\n            }\r\n        )\r\n    }\r\n\r\n    encode(): SmartBuffer {\r\n        const buf = new SmartBuffer()\r\n        this.encodeFTEXHeader(buf)\r\n\r\n        // The OUTL table will be compressed by default\r\n        const outlData = new SmartBuffer()\r\n        this.encodeOUTL(outlData)\r\n        this.compressTable(outlData)\r\n\r\n        this.encodeDEFL(buf)\r\n\r\n        if (this.fnam.length) this.encodeFNAM(buf)\r\n        if (this.fmet) this.encodeFMET(buf)\r\n        // if (this.outl.length) this.encodeOUTL(buf)\r\n        if (this.glph.length) this.encodeGLPH(buf)\r\n\r\n        return buf\r\n    }\r\n\r\n    decode(buffer: SmartBuffer) {\r\n        if (\r\n            buffer.readString(4, \"ascii\") !== \"FTEX\"\r\n        )\r\n            throw new Error(\"Not a supported FTEX file.\")\r\n        if (\r\n            buffer.readUInt8() !== this.ftexVersion\r\n        )\r\n            throw new Error(\"Not a supported FTEX version.\")\r\n    \r\n        const numTables = buffer.readUInt16LE()\r\n        const requiredTables = [\r\n            \"OUTL\", \"GLPH\", \"FMET\", \"FNAM\"\r\n        ]\r\n        const supportedTables = [\r\n            ...requiredTables, \"DEFL\"\r\n        ]\r\n\r\n        for (let i = 0; i < numTables; i++) {\r\n            const tag = buffer.readString(4, \"ascii\")\r\n            \r\n            if (!supportedTables.includes(tag))\r\n                throw new Error(`Unsupported table: ${tag}.`)\r\n\r\n            const index = requiredTables.indexOf(tag)\r\n            if (index >= 0)\r\n                requiredTables.splice(index, 1)\r\n            \r\n            this.decodeTable(tag, buffer)\r\n        }\r\n\r\n        this.defl.forEach(\r\n            buf => {\r\n                const tableBuffer = this.decompressTable(buf)\r\n\r\n                const tag = tableBuffer.readString(4, \"ascii\")\r\n\r\n                if (!supportedTables.includes(tag))\r\n                    throw new Error(`Unsupported table: ${tag}.`)\r\n\r\n                const index = requiredTables.indexOf(tag)\r\n                \r\n                if (index >= 0)\r\n                    requiredTables.splice(index, 1)\r\n\r\n                this.decodeTable(tag, tableBuffer)\r\n            }\r\n        )\r\n\r\n        if (requiredTables.length)\r\n            throw new Error(\r\n                `The following required tables were not found: ${requiredTables.join(\", \")}.`\r\n            )\r\n    }\r\n\r\n    decodeTable(tag: string, buffer: SmartBuffer) {\r\n        switch (tag) {\r\n            case \"DEFL\":\r\n                this.decodeDEFL(buffer)\r\n                break\r\n            case \"FMET\":\r\n                this.decodeFMET(buffer)\r\n                break\r\n            case \"FNAM\":\r\n                this.decodeFNAM(buffer)\r\n                break\r\n            case \"OUTL\":\r\n                this.decodeOUTL(buffer)\r\n                break\r\n            case \"GLPH\":\r\n                this.decodeGLPH(buffer)\r\n                break\r\n        }\r\n    }\r\n\r\n    encodeVString(buf: SmartBuffer, str: string) {\r\n        buf.writeUInt16LE(str.length)\r\n        buf.writeString(str, \"utf-8\")\r\n    }\r\n\r\n    decodeVString(buf: SmartBuffer): string {\r\n        const length = buf.readUInt16LE()\r\n        return buf.readString(length, \"utf-8\")\r\n    }\r\n\r\n    // FTEX - File Header\r\n    encodeFTEXHeader(buffer: SmartBuffer) {\r\n        buffer.writeString(\"FTEX\", \"ascii\")\r\n        buffer.writeUInt8(this.ftexVersion)\r\n        buffer.writeUInt16LE(this.tableCount)\r\n    }\r\n\r\n    // DEFL - Compressed Tables\r\n    compressTable(table: SmartBuffer) {\r\n        const buf = table.toBuffer()\r\n\r\n        this.defl.push(\r\n            deflateSync(buf)\r\n        )\r\n    }\r\n\r\n    decompressTable(defl: Buffer): SmartBuffer {\r\n        return SmartBuffer.fromBuffer(\r\n            inflateSync(defl)\r\n        )\r\n    }\r\n\r\n    encodeDEFL(buffer: SmartBuffer) {\r\n        buffer.writeString(\"DEFL\", \"ascii\")\r\n        buffer.writeUInt16LE(this.defl.length)\r\n\r\n        this.defl.forEach(\r\n            buf => {\r\n                buffer.writeUInt32LE(buf.length)\r\n                buffer.writeBuffer(buf)\r\n            }\r\n        )\r\n    }\r\n\r\n    decodeDEFL(buffer: SmartBuffer) {\r\n        const count = buffer.readUInt16LE()\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const length = buffer.readUInt32LE()\r\n\r\n            this.defl.push(\r\n                buffer.readBuffer(length)\r\n            )\r\n        }\r\n    }\r\n\r\n    // FMET - Font Vertical Metrics\r\n    setFMET(font: Font) {\r\n        this.fmet = font.metrics\r\n    }\r\n\r\n    encodeFMET(buffer: SmartBuffer) {\r\n        buffer.writeString(\"FMET\", \"ascii\")\r\n        buffer.writeFloatLE(this.fmet.ascender)\r\n        buffer.writeFloatLE(this.fmet.descender)\r\n        buffer.writeFloatLE(this.fmet.xHeight)\r\n    }\r\n\r\n    decodeFMET(buffer: SmartBuffer) {\r\n        this.fmet = {\r\n            ascender: buffer.readFloatLE(),\r\n            descender: buffer.readFloatLE(),\r\n            xHeight: buffer.readFloatLE()\r\n        }\r\n    }\r\n\r\n    // OUTL - Outlines\r\n    addOUTL(beziers: BezierCurve[]) {\r\n        const handles = beziers.map(\r\n            b => b.points\r\n        ).flat().map(\r\n            p => {\r\n                return {\r\n                    type: p.type,\r\n                    base: [p.base.x, p.base.y],\r\n                    before: [p.before.x, p.before.y],\r\n                    after: [p.after.x, p.after.y]\r\n                }\r\n            }\r\n        )\r\n        const startIndices: number[] = []\r\n\r\n        let acc = 0\r\n        beziers.forEach(\r\n            b => {\r\n                startIndices.push(acc)\r\n                acc += b.points.length\r\n            }\r\n        )\r\n\r\n        return this.outl.push(\r\n            {\r\n                handles,\r\n                startIndices\r\n            }\r\n        ) - 1\r\n    }\r\n\r\n    encodeOUTL(buffer: SmartBuffer) {\r\n        buffer.writeString(\"OUTL\", \"ascii\")\r\n        buffer.writeUInt32LE(this.outl.length)\r\n\r\n        this.outl.forEach(\r\n            outl => {\r\n                buffer.writeUInt16LE(outl.handles.length)\r\n                buffer.writeUInt16LE(outl.startIndices.length)\r\n\r\n                outl.handles.forEach(\r\n                    h => {\r\n                        buffer.writeUInt8(h.type)\r\n                        buffer.writeFloatLE(h.base[0])\r\n                        buffer.writeFloatLE(h.base[1])\r\n                        buffer.writeFloatLE(h.before[0])\r\n                        buffer.writeFloatLE(h.before[1])\r\n                        buffer.writeFloatLE(h.after[0])\r\n                        buffer.writeFloatLE(h.after[1])\r\n                    }\r\n                )\r\n                outl.startIndices.forEach(\r\n                    idx => buffer.writeUInt16LE(idx)\r\n                )\r\n            }\r\n        )\r\n    }\r\n\r\n    decodeOUTL(buffer: SmartBuffer) {\r\n        const count = buffer.readUInt32LE()\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const handleCount = buffer.readInt16LE()\r\n            const curveCount = buffer.readInt16LE()\r\n\r\n            const handles: {\r\n                type: number,\r\n                base: number[],\r\n                before: number[],\r\n                after: number[]\r\n            }[] = []\r\n            const startIndices: number[] = []\r\n\r\n            for (let j = 0; j < handleCount; j++) {\r\n                handles.push(\r\n                    {\r\n                        type: buffer.readUInt8(),\r\n                        base: [\r\n                            buffer.readFloatLE(),\r\n                            buffer.readFloatLE()\r\n                        ],\r\n                        before: [\r\n                            buffer.readFloatLE(),\r\n                            buffer.readFloatLE()\r\n                        ],\r\n                        after: [\r\n                            buffer.readFloatLE(),\r\n                            buffer.readFloatLE()\r\n                        ]\r\n                    }\r\n                )\r\n            }\r\n\r\n            for (let j = 0; j < curveCount; j++) {\r\n                startIndices.push(buffer.readUInt16LE())\r\n            }\r\n\r\n            this.outl.push(\r\n                {\r\n                    handles, startIndices\r\n                }\r\n            )\r\n        }\r\n    }\r\n\r\n    // GLPH - Glyphs\r\n    setGLPH(font: Font) {\r\n        font.glyphs.forEach(\r\n            g => {\r\n                const outlines = [g.beziers].map(\r\n                    beziers => this.addOUTL(beziers)\r\n                )\r\n\r\n                this.glph.push(\r\n                    {\r\n                        codePoint: g.codePoint,\r\n                        leftSide: g.metrics.leftBearing,\r\n                        rightSide: g.metrics.rightBearing,\r\n                        name: g.name,\r\n                        outlines\r\n                    }\r\n                )\r\n            }\r\n        )\r\n    }\r\n\r\n    encodeGLPH(buffer: SmartBuffer) {\r\n        buffer.writeString(\"GLPH\", \"ascii\")\r\n        buffer.writeUInt32LE(this.glph.length)\r\n\r\n        this.glph.forEach(\r\n            g => {\r\n                buffer.writeUInt32LE(g.codePoint ?? 0)\r\n                this.encodeVString(buffer, g.name)\r\n                buffer.writeFloatLE(g.leftSide)\r\n                buffer.writeFloatLE(g.rightSide)\r\n                buffer.writeUInt16LE(g.outlines.length)\r\n\r\n                g.outlines.forEach(\r\n                    idx => buffer.writeUInt32LE(idx)\r\n                )\r\n            }\r\n        )\r\n    }\r\n\r\n    decodeGLPH(buffer: SmartBuffer) {\r\n        const count = buffer.readUInt32LE()\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const outlines: number[] = []\r\n            const glyph: GLPHEntry = {\r\n                codePoint: buffer.readUInt32LE(),\r\n                name: this.decodeVString(buffer),\r\n                leftSide: buffer.readFloatLE(),\r\n                rightSide: buffer.readFloatLE(),\r\n                outlines\r\n            }\r\n\r\n            const outlineCount = buffer.readUInt16LE()\r\n            for (let j = 0; j < outlineCount; j++) {\r\n                outlines.push(\r\n                    buffer.readUInt32LE()\r\n                )\r\n            }\r\n\r\n            this.glph.push(glyph)\r\n        }\r\n    }\r\n\r\n    // FNAM - Font Names\r\n    setFNAM(font: Font) {\r\n        Object.keys(font.info).forEach(\r\n            key => {\r\n                const index = fontInfoIndices.indexOf(key)\r\n                if (index < 0) return\r\n\r\n                this.fnam.push(\r\n                    {\r\n                        index,\r\n                        name: (font.info as any)[key]\r\n                    }\r\n                )\r\n            }\r\n        )\r\n    }\r\n\r\n    encodeFNAM(buffer: SmartBuffer) {\r\n        buffer.writeString(\"FNAM\", \"ascii\")\r\n        buffer.writeUInt8(this.fnam.length)\r\n\r\n        this.fnam.forEach(\r\n            n => {\r\n                buffer.writeUInt8(n.index)\r\n                this.encodeVString(buffer, n.name)\r\n            }\r\n        )\r\n    }\r\n\r\n    decodeFNAM(buffer: SmartBuffer) {\r\n        const count = buffer.readUInt8()\r\n\r\n        for (let i = 0; i < count; i++) {\r\n            const type = buffer.readUInt8()\r\n            const str = this.decodeVString(buffer)\r\n\r\n            this.fnam.push(\r\n                {\r\n                    index: type,\r\n                    name: str\r\n                }\r\n            )\r\n        }\r\n    }\r\n}","import { readFileSync, writeFileSync } from \"fs\";\r\nimport { extname } from \"path\";\r\nimport { SmartBuffer } from \"smart-buffer\";\r\nimport { Font } from \"../font/font\";\r\nimport { FTEX1 } from \"./ftex/ftex\";\r\nimport { exportFont_opentype } from \"./opentype.js/export\";\r\nimport { importFont_opentype } from \"./opentype.js/import\";\r\n\r\nexport function openFont(filePath: string): Font {\r\n    const ext = extname(filePath.toLowerCase())\r\n\r\n    if (ext === \".ftex\") {\r\n        // FTE Font\r\n        const ftex = new FTEX1()\r\n        ftex.decode(\r\n            SmartBuffer.fromBuffer(readFileSync(filePath))\r\n        )\r\n\r\n        return ftex.getFont()\r\n    } else {\r\n        // Opentype.js, take over\r\n        return importFont_opentype(filePath)\r\n    }\r\n}\r\n\r\nexport function saveFont(font: Font, filePath: string) {\r\n    const ext = extname(filePath.toLowerCase())\r\n\r\n    if (ext === \".ftex\") {\r\n        // FTE Font\r\n        const ftex = FTEX1.fromFont(font)\r\n        const buf = ftex.encode().toBuffer()\r\n\r\n        writeFileSync(filePath, buf)\r\n    } else if (ext === \".ttf\" || ext === \".otf\") {\r\n        // Opentype.js\r\n        exportFont_opentype(font, filePath)\r\n    }\r\n}","import { Font } from \"../../font/font\"\r\nimport {\r\n    Font as OTFont,\r\n    Glyph as OTGlyph,\r\n    Path as OTPath\r\n} from \"opentype.js\"\r\nimport { Glyph } from \"../../font/glyph\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { writeFileSync } from \"fs\"\r\n\r\nfunction glyphToOTPath(glyph: Glyph, targetCapHeight = 1000) {\r\n    const path = new OTPath()\r\n    const scaleFactor = targetCapHeight / 512\r\n\r\n    const conv = (point: Point) => {\r\n        return {\r\n            x: (point.x - glyph.metrics.leftBearing) * scaleFactor,\r\n            y: (512 - point.y) * scaleFactor\r\n        }\r\n    }\r\n\r\n    for (const bezier of glyph.finalBeziers) {\r\n        if (!bezier.points.length) continue\r\n        \r\n        const first = conv(bezier.points[0].base)\r\n        path.moveTo(first.x, first.y)\r\n\r\n        for (let i = 0; i < bezier.points.length; i++) {\r\n            const pt = bezier.points[i]\r\n            const next = bezier.points[\r\n                (i + 1) % bezier.points.length\r\n            ]\r\n\r\n            const c1 = conv(pt.after)\r\n            const c2 = conv(next.before)\r\n            const b = conv(next.base)\r\n\r\n            path.curveTo(\r\n                c1.x, c1.y,\r\n                c2.x, c2.y,\r\n                b.x, b.y\r\n            )\r\n        }\r\n\r\n        path.closePath()\r\n    }\r\n\r\n    return path\r\n}\r\n\r\nexport function exportFont_opentype(font: Font, targetFile: string) {\r\n    const notDef = new OTGlyph({\r\n        name: \".notdef\",\r\n        unicode: 0,\r\n        advanceWidth: 650, // TODO!!!\r\n        path: new OTPath()\r\n    })\r\n\r\n    const targetCapHeight = 2000\r\n    const scaleFactor = targetCapHeight / 512\r\n    \r\n    const otfont = new OTFont({\r\n        familyName: font.info.fontFamily,\r\n        styleName: font.info.fontSubfamily,\r\n        postScriptName: `${font.info.fontFamily}-${font.info.fontSubfamily}`,\r\n        unitsPerEm: (font.metrics.descender - font.metrics.ascender) * scaleFactor, // TODO!!\r\n        ascender: (512 - font.metrics.ascender) * scaleFactor,\r\n        descender: (512 - font.metrics.descender) * scaleFactor,\r\n        glyphs: [\r\n            ...font.glyphs.map(g => new OTGlyph({\r\n                name: g.name,\r\n                unicode: g.codePoint,\r\n                advanceWidth: Math.round((g.metrics.rightBearing - g.metrics.leftBearing) * scaleFactor),\r\n                path: glyphToOTPath(g, targetCapHeight)\r\n            })),\r\n            notDef\r\n        ],\r\n        ///@ts-ignore\r\n        tables: {\r\n            version: 4,\r\n            achVendID: \"SFTE\",\r\n            sCapHeight: targetCapHeight,\r\n            sxHeight: (512 - font.metrics.xHeight) * scaleFactor,\r\n            sTypoAscender: (512 - font.metrics.ascender) * scaleFactor,\r\n            sTypoDescender: (512 - font.metrics.descender) * scaleFactor\r\n        }\r\n    })\r\n\r\n    const buf = Buffer.from(otfont.toArrayBuffer())\r\n\r\n    writeFileSync(targetFile, buf)\r\n}","import { Font as OTFont, Glyph as OTGlyph, load, loadSync, PathCommand } from \"opentype.js\";\r\nimport { Font, FontInfo } from \"../../font/font\";\r\nimport { Glyph } from \"../../font/glyph\";\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\";\r\nimport { BezierPoint, BezierPointType } from \"../../geometry/bezier/point\";\r\nimport { Point } from \"../../geometry/point\";\r\nimport { lerp } from \"../../utils/lerp\";\r\n\r\nfunction convertOTCoordinates(\r\n    otfont: OTFont, x: number, y: number\r\n): {x: number, y: number} {\r\n    const scaleFactor = 512 / otfont.tables.os2.sCapHeight\r\n\r\n    return {\r\n        x: x * scaleFactor,\r\n        y: (otfont.tables.os2.sCapHeight - y) * scaleFactor // easier to work with\r\n    }\r\n}\r\n\r\nfunction generateCurvesFromOTGlyph(\r\n    otfont: OTFont, otglyph: OTGlyph\r\n): BezierCurve[] {\r\n    const curves: BezierCurve[] = []\r\n    let curve = new BezierCurve()\r\n\r\n    const conv = (\r\n        x: number, y: number\r\n    ) => convertOTCoordinates(otfont, x, y)\r\n    \r\n    ///@ts-ignore\r\n    otglyph.path.commands.forEach(\r\n        (cmd: PathCommand) => {\r\n            switch (cmd.type) {\r\n                case \"M\": {\r\n                    if (curve.points.length)\r\n                        curves.push(curve)\r\n                    \r\n                    curve = new BezierCurve()\r\n                    \r\n                    const coords = conv(cmd.x, cmd.y)\r\n                    curve.addPoint(\r\n                        new BezierPoint(\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(coords.x, coords.y),\r\n                            BezierPointType.free\r\n                        )\r\n                    )\r\n\r\n                    break\r\n                }\r\n                case \"L\": {\r\n                    const coords = conv(cmd.x, cmd.y)\r\n                    curve.addPoint(\r\n                        new BezierPoint(\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(coords.x, coords.y)\r\n                        )\r\n                    )\r\n\r\n                    break\r\n                }\r\n                case \"C\": {\r\n                    const c1coords = conv(cmd.x1, cmd.y1)\r\n                    const c2coords = conv(cmd.x2, cmd.y2)\r\n                    const coords = conv(cmd.x, cmd.y)\r\n\r\n                    if (!curve.points.length) return // WHO MALFORMED MY OTF\r\n                    const prevPoint = curve.points[curve.points.length - 1]\r\n                    prevPoint.after.x = c1coords.x\r\n                    prevPoint.after.y = c1coords.y\r\n\r\n                    curve.addPoint(\r\n                        new BezierPoint(\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(c2coords.x, c2coords.y),\r\n                            new Point(coords.x, coords.y)\r\n                        )\r\n                    )\r\n\r\n                    break\r\n                }\r\n                case \"Q\": {\r\n                    const c1coords = conv(cmd.x1, cmd.y1)\r\n                    const coords = conv(cmd.x, cmd.y)\r\n\r\n                    if (!curve.points.length) return // WHO MALFORMED MY OTF\r\n                    const prevPoint = curve.points[curve.points.length - 1]\r\n                    prevPoint.after.x = lerp(1/3, c1coords.x, prevPoint.base.x)\r\n                    prevPoint.after.y = lerp(1/3, c1coords.y, prevPoint.base.y)\r\n\r\n                    curve.addPoint(\r\n                        new BezierPoint(\r\n                            new Point(coords.x, coords.y),\r\n                            new Point(\r\n                                lerp(1/3, c1coords.x, coords.x),\r\n                                lerp(1/3, c1coords.y, coords.y)\r\n                            ),\r\n                            new Point(coords.x, coords.y)\r\n                        )\r\n                    )\r\n\r\n                    break\r\n                }\r\n                case \"Z\": {\r\n                    if (curve.points.length) {\r\n                        const first = curve.points[0]\r\n\r\n                        if (curve.points.length > 1) {\r\n                            const last = curve.points[curve.points.length - 1]\r\n\r\n                            if (\r\n                                first.base.x === last.base.x &&\r\n                                first.base.y === last.base.y\r\n                            ) {\r\n                                first.before.x = last.before.x\r\n                                first.before.y = last.before.y\r\n\r\n                                curve.points.splice(curve.points.length - 1, 1)\r\n                            }\r\n                        }\r\n\r\n                        curve.points.forEach(p => p.determineType())\r\n                        curves.push(curve)\r\n                    }\r\n                    \r\n                    curve = new BezierCurve()\r\n                    \r\n                    break\r\n                }\r\n            }\r\n        }\r\n    )\r\n\r\n    if (curve.points.length) {\r\n        curve.points.forEach(p => p.determineType())\r\n        curves.push(curve)\r\n    }\r\n\r\n    return curves\r\n}\r\n\r\nfunction fteGlyphFromOTGlyph(font: Font, otfont: OTFont, otglyph: OTGlyph) {\r\n    const scaleFactor = 512 / otfont.tables.os2.sCapHeight\r\n    const beziers = generateCurvesFromOTGlyph(otfont, otglyph)\r\n\r\n    const glyphMetrics = otglyph.getMetrics()\r\n\r\n    return new Glyph(\r\n        font,\r\n        otglyph.name,\r\n        otglyph.unicode,\r\n        {\r\n            leftBearing: 0,\r\n            rightBearing: (\r\n                glyphMetrics.rightSideBearing + glyphMetrics.xMax\r\n            ) * scaleFactor\r\n        },\r\n        beziers\r\n    )\r\n}\r\n\r\nfunction fteFontFromOTFont(otfont: OTFont) {\r\n    const glyphs: Glyph[] = [] // For now, don't want to import the entirety of Inter just yet\r\n\r\n    const scaleFactor = 512 / otfont.tables.os2.sCapHeight\r\n\r\n    const info: any = {}\r\n    const names = otfont.names as any\r\n\r\n    Object.keys(otfont.names).forEach(\r\n        k => {\r\n            if (!names[k]) info[k] = \"\"\r\n            info[k] = names[k]?.en ?? \"\"\r\n        }\r\n    )\r\n        \r\n    return new Font(\r\n        info as FontInfo,\r\n        {\r\n            descender: -otfont.descender * scaleFactor + 512,\r\n            ascender: -(otfont.ascender - otfont.tables.os2.sCapHeight) * scaleFactor,\r\n            xHeight: (otfont.tables.os2.sCapHeight - otfont.tables.os2.sxHeight) * scaleFactor\r\n        },\r\n        glyphs\r\n    )\r\n}\r\n\r\nexport function importFont_opentype(filePath: string): Font {\r\n    const otfont = loadSync(filePath)\r\n\r\n    const font = fteFontFromOTFont(otfont)\r\n\r\n    const glyphs: Glyph[] = []\r\n    for (let i = 0; i < otfont.glyphs.length; i++) {\r\n        glyphs.push(\r\n            fteGlyphFromOTGlyph(\r\n                font, otfont,\r\n                otfont.glyphs.get(i)\r\n            )\r\n        )\r\n    }\r\n    font.addGlyph(...glyphs)\r\n\r\n    return font\r\n}","import { exec, execSync } from \"child_process\"\r\nimport { join } from \"path\"\r\nimport { Font } from \"../../font/font\"\r\nimport { Glyph } from \"../../font/glyph\"\r\nimport { undo } from \"../../undo/history\"\r\nimport { GLYFPoint, NAMEEntries, NumberOrVariation, OTFCCData } from \"./types\"\r\nimport { remote } from \"electron\"\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\"\r\nimport { lerp } from \"../../utils/lerp\"\r\n\r\nlet otfccPath: string\r\n\r\nexport function setOtfccPath(path: string) {\r\n    otfccPath = path\r\n}\r\n\r\nconst novar = (x: NumberOrVariation) => {\r\n    if (typeof x === \"number\") return x\r\n    return x[0]\r\n}\r\n\r\nfunction convertOTFCCCoordinates(\r\n    data: OTFCCData, x: number, y: number\r\n): {x: number, y: number} {\r\n    const scaleFactor = 512 / data.OS_2.sCapHeight\r\n\r\n    return {\r\n        x: x * scaleFactor,\r\n        y: (data.OS_2.sCapHeight - y) * scaleFactor // easier to work with\r\n    }\r\n}\r\n\r\nexport async function importFontData_otfcc(filePath: string): Promise<OTFCCData> {\r\n    if (!otfccPath) return\r\n\r\n    const stdout = execSync(\r\n        `\"${join(otfccPath, \"otfccdump\")}\" \"${filePath}\"`,\r\n        {\r\n            maxBuffer: 100 * 1024 * 1024\r\n        }\r\n    ).toString(\"utf-8\").trim()\r\n    \r\n    const data = JSON.parse(stdout)\r\n\r\n    return data\r\n}","export const defaultAppSettings = {\r\n    theme: \"dark\"\r\n}\r\n\r\nexport const defaultPerFontSettings = {\r\n    gridActive: true,\r\n    gridMainGap: 10\r\n}","import { EventEmitter } from \"events\";\r\nimport { AppSettings, FontSettings } from \"./settings\";\r\n\r\nexport function createSettingsProxy<T extends (AppSettings | FontSettings)>(\r\n    source: Partial<T>,\r\n    defaults: T,\r\n    eventTarget: EventEmitter\r\n): T {\r\n    return new Proxy<T>(\r\n        defaults,\r\n        {\r\n            get: (o: T, key: keyof T, recv) => {\r\n                if (key in source) return source[key]\r\n                return defaults[key]\r\n            },\r\n            set: (o: T, key: keyof T, value: T[keyof T], recv): boolean => {\r\n                source[key] = value\r\n                eventTarget.emit(\r\n                    \"settingChanged\", key\r\n                )\r\n\r\n                return true\r\n            },\r\n            deleteProperty: (o: T, key: keyof T): boolean => {\r\n                if (key in source)\r\n                    delete source[key]\r\n\r\n                return true\r\n            }\r\n        }\r\n    )\r\n}","import { EventEmitter } from \"events\"\r\nimport { Font } from \"../font/font\"\r\nimport { defaultAppSettings, defaultPerFontSettings } from \"./defaults\"\r\nimport { createSettingsProxy } from \"./proxy\"\r\n\r\nexport type FontSettings = typeof defaultPerFontSettings\r\nexport type AppSettings = typeof defaultAppSettings\r\n\r\nconst appSettings: Partial<AppSettings> = {}\r\n\r\nexport const settingsEvent = new EventEmitter()\r\nexport const settings = createSettingsProxy(\r\n    appSettings, defaultAppSettings, settingsEvent\r\n)\r\n\r\nexport function createFontSettings(\r\n    font: Font, settings: Partial<FontSettings>\r\n): FontSettings {\r\n    return createSettingsProxy(\r\n        settings, defaultPerFontSettings, font\r\n    )\r\n}","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./app.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js!./editor.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js!./main.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/sass-loader/dist/cjs.js!./panel.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./welcome.scss\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","import { accelStringToUserFriendly } from \"../utils/accelerator\";\r\nimport { ToolSubAction } from \"../viewport/tools/tool\";\r\nimport { Viewport } from \"../viewport/viewport\";\r\n\r\nconst subactionContainer = document.querySelector(\"div.subactions\")\r\n\r\nexport function updateSubactions(viewport: Viewport, subactionGroups: ToolSubAction[][]) {\r\n    subactionContainer.innerHTML = \"\"\r\n\r\n    for (const group of subactionGroups) {\r\n        const subactionGroup = document.createElement(\"div\")\r\n\r\n        for (const subaction of group) {\r\n            const button = document.createElement(\"button\")\r\n            button.title = `${subaction.name}${\r\n                subaction.accelerator ? ` (${\r\n                    accelStringToUserFriendly(subaction.accelerator)\r\n                })` : \"\"\r\n            }`\r\n\r\n            button.addEventListener(\"click\", () => {\r\n                subaction.handler()\r\n                viewport.render()\r\n            })\r\n\r\n            button.innerHTML = `\r\n                <img src=\"res/icons/${subaction.icon}.svg\">\r\n            `\r\n\r\n            subactionGroup.appendChild(button)\r\n        }\r\n\r\n        subactionContainer.appendChild(subactionGroup)\r\n    }\r\n}","import { Glyph } from \"../font/glyph\"\r\nimport { GlyphContext } from \"../viewport/context/glyph\"\r\nimport { Viewport } from \"../viewport/viewport\"\r\n\r\nconst glyphBar = document.querySelector(\"div.glyphBar\") as HTMLDivElement\r\n\r\nexport function getGlyphBarGlyphs(allGlyphs: Glyph[]) {\r\n    const glyphs: Glyph[] = []\r\n\r\n    glyphBar.childNodes.forEach(\r\n        node => {\r\n            if (node instanceof Text) {\r\n                glyphs.push(\r\n                    ...node.textContent.split(\"\").map(\r\n                        chr => allGlyphs.find(\r\n                            g => g.codePoint === chr.codePointAt(0)\r\n                        )\r\n                    )\r\n                )\r\n            } else if (node instanceof HTMLDivElement) {\r\n                glyphs.push(\r\n                    allGlyphs.find(g => g.name === node.textContent)\r\n                )\r\n            }\r\n        }\r\n    )\r\n\r\n    return glyphs\r\n}\r\n\r\nexport function appendCharacter(glyph: Glyph) {\r\n    if (glyph.codePoint >= 32) {\r\n        glyphBar.append(\r\n            String.fromCharCode(glyph.codePoint)\r\n        )\r\n    } else {\r\n        const nonTextGlyph = document.createElement(\"div\")\r\n        nonTextGlyph.className = \"ntglyph\"\r\n        nonTextGlyph.contentEditable = \"false\"\r\n\r\n        nonTextGlyph.innerHTML = `<span>${glyph.name}</span>`\r\n\r\n        glyphBar.appendChild(nonTextGlyph)\r\n    }\r\n    glyphBar.dispatchEvent(new InputEvent(\"input\"))\r\n}\r\n\r\nexport function prepareGlyphBar(viewport: Viewport) {\r\n    glyphBar.addEventListener(\"keydown\", (e) => {\r\n        if (e.code === \"KeyZ\" && e.ctrlKey) {\r\n            e.preventDefault()\r\n        }\r\n    })\r\n\r\n    glyphBar.addEventListener(\"input\", () => {\r\n        if (!(viewport.context instanceof GlyphContext)) return\r\n\r\n        const glyphs = getGlyphBarGlyphs(\r\n            viewport.context.glyph.font.glyphs\r\n        )\r\n        if (!glyphs.length) return\r\n\r\n        viewport.context.setGlyphs(glyphs)\r\n        viewport.tool.updateContext(viewport.context)\r\n        viewport.render()\r\n    })\r\n\r\n    document.querySelector(\"button.prevGlyph\").addEventListener(\r\n        \"click\", () => {\r\n            if (!(viewport.context instanceof GlyphContext)) return\r\n\r\n            viewport.context.setGlyphs(\r\n                null, viewport.context.currentIndex === 0 ?\r\n                      viewport.context.glyphs.length - 1 :\r\n                      viewport.context.currentIndex - 1\r\n            )\r\n            viewport.tool.updateContext(viewport.context)\r\n            viewport.render()\r\n        }\r\n    )\r\n    document.querySelector(\"button.nextGlyph\").addEventListener(\r\n        \"click\", () => {\r\n        if (!(viewport.context instanceof GlyphContext)) return\r\n\r\n            viewport.context.setGlyphs(\r\n                null, viewport.context.currentIndex === viewport.context.glyphs.length - 1 ?\r\n                      0 :\r\n                      viewport.context.currentIndex + 1\r\n            )\r\n            viewport.tool.updateContext(viewport.context)\r\n            viewport.render()\r\n        }\r\n    )\r\n}\r\n","import { Font } from \"../font/font\"\r\nimport { Glyph } from \"../font/glyph\"\r\nimport { BezierCurve } from \"../geometry/bezier/curve\"\r\nimport { appendCharacter } from \"./glyphBar\"\r\n\r\nconst glyphListContainer = document.querySelector(\"div.glyphList\")\r\n\r\nfunction drawGlyphPreview(glyph: Glyph) {\r\n    const canvas: HTMLCanvasElement = glyphListContainer.querySelector(\r\n        `div[data-name=\"${glyph.name}\"] canvas`\r\n    )\r\n    if (!canvas) return\r\n\r\n    const ctx = canvas.getContext(\"2d\")\r\n\r\n    ctx.resetTransform()\r\n    ctx.clearRect(0, 0, 90, 90)\r\n    \r\n    const path = BezierCurve.getPath2D(\r\n        glyph.finalBeziers\r\n    )\r\n\r\n    const width = (\r\n        glyph.metrics.rightBearing - glyph.metrics.leftBearing\r\n    ) * 50 / 512\r\n\r\n    ctx.translate((90 - width) / 2, 20)\r\n    ctx.scale(50 / 512, 50 / 512)\r\n    ctx.fillStyle = \"#000\"\r\n    ctx.fill(path)\r\n}\r\n\r\nexport function setActiveGlyph(glyph: Glyph) {\r\n    const currentActiveGlyph = glyphListContainer.querySelector(\r\n        \"div.glyph.active\"\r\n    )\r\n    if (currentActiveGlyph)\r\n        currentActiveGlyph.classList.remove(\"active\")\r\n    \r\n    document.querySelector(\r\n        `div[data-name=\"${glyph.name}\"]`\r\n    ).classList.add(\"active\")\r\n}\r\n\r\nexport function prepareGlyphList(font: Font) {\r\n    glyphListContainer.innerHTML = \"\"\r\n\r\n    font.glyphs.sort(\r\n        (g1, g2) => g1.comparableCodePoint - g2.comparableCodePoint\r\n    ).forEach(\r\n        glyph => {\r\n            const glyphDiv = document.createElement(\"div\")\r\n            glyphDiv.className = \"glyph\"\r\n            glyphDiv.setAttribute(\"data-name\", glyph.name)\r\n\r\n            const glyphLabel = document.createElement(\"label\")\r\n            glyphLabel.textContent = glyph.name\r\n            glyphDiv.appendChild(glyphLabel)\r\n\r\n            const glyphCanvas = document.createElement(\"canvas\")\r\n            glyphCanvas.width = 90\r\n            glyphCanvas.height = 90\r\n            glyphDiv.appendChild(glyphCanvas)\r\n\r\n            glyphListContainer.appendChild(glyphDiv)\r\n\r\n            glyphDiv.addEventListener(\"dblclick\", () => {\r\n                appendCharacter(glyph)\r\n            })\r\n\r\n            drawGlyphPreview(glyph)\r\n        }\r\n    )\r\n\r\n    font.on(\"glyphModified\", (glyph: Glyph) => {\r\n        drawGlyphPreview(glyph)\r\n    })\r\n}","import { currentFont } from \"../app\"\r\nimport { Font } from \"../font/font\"\r\nimport { FontSettings } from \"../settings/settings\"\r\n\r\nlet preparedFontSettings = false\r\n\r\nexport function prepareTabbedPanel() {\r\n    document.querySelectorAll(\"aside nav button\").forEach(\r\n        button => {\r\n            const tabId = button.getAttribute(\"data-tab\")\r\n\r\n            button.addEventListener(\"click\", () => {\r\n                const currentButton = document.querySelector(\"aside nav button.active\")\r\n                const currentPanel = document.querySelector(\"aside div.panelContents.active\")\r\n\r\n                if (currentButton && currentPanel) {\r\n                    currentButton.classList.remove(\"active\")\r\n                    currentPanel.classList.remove(\"active\")\r\n                }\r\n\r\n                document.querySelector(\r\n                    `aside div.panelContents[data-tab=${tabId}]`\r\n                ).classList.add(\"active\")\r\n                button.classList.add(\"active\")\r\n            })\r\n        }\r\n    )\r\n}\r\n\r\nexport function prepareFontSettings() {\r\n    if (preparedFontSettings) return\r\n    preparedFontSettings = true\r\n    \r\n    document.querySelectorAll(\r\n        \"input[data-font-setting]\"\r\n    ).forEach(\r\n        (input: HTMLInputElement) => {\r\n            const key: keyof FontSettings = input.getAttribute(\r\n                \"data-font-setting\"\r\n            ) as (keyof FontSettings)\r\n            if (!(key in currentFont.settings)) return\r\n\r\n            input.value = currentFont.settings[key].toString()\r\n\r\n            input.addEventListener(\"input\", () => {\r\n                if (typeof currentFont.settings[key] === \"number\")\r\n                    (currentFont.settings[key] as any) = +input.value\r\n                else if (typeof currentFont.settings[key] === \"string\")\r\n                    (currentFont.settings[key] as any) = input.value\r\n            })\r\n        }\r\n    )\r\n}\r\n\r\nexport function addFontSettingsEvents() {\r\n    currentFont.on(\"settingChanged\", (key: keyof FontSettings) => {\r\n        const input = document.querySelector(\r\n            `input[data-font-setting=${key}]`\r\n        ) as HTMLInputElement\r\n        if (!input) return\r\n\r\n        input.value = currentFont.settings[key].toString()\r\n    })\r\n}","import { settings } from \"../settings/settings\"\r\n\r\nconst fteThemes = [\r\n    {\r\n        theme: \"light\",\r\n\r\n        handleSelected: \"#111\",\r\n        handleFill: \"#fff\",\r\n        handleMetricFill: \"#444\",\r\n        handleControlArm: \"#555\",\r\n        handleControlFill: \"#555\",\r\n\r\n        glyphOutline: \"#000\",\r\n        glyphGapOutline: \"#fff\",\r\n        glyphFill: \"#888\",\r\n        glyphOtherFill: \"#000\",\r\n        glyphMetric: \"#3338\",\r\n\r\n        gindicatorActive: \"#aaa\",\r\n        gindicatorActiveText: \"#555\",\r\n        gindicator: \"#eee\",\r\n        gindicatorText: \"#aaa\",\r\n\r\n        guideActive: \"#f0f\",\r\n        guideGrid: \"#3332\"\r\n    },\r\n    {\r\n        theme: \"dark\",\r\n\r\n        handleSelected: \"#eee\",\r\n        handleFill: \"#000\",\r\n        handleMetricFill: \"#888\",\r\n        handleControlArm: \"#999\",\r\n        handleControlFill: \"#999\",\r\n\r\n        glyphOutline: \"#fff\",\r\n        glyphGapOutline: \"#222\",\r\n        glyphFill: \"#333\",\r\n        glyphOtherFill: \"#fff\",\r\n        glyphMetric: \"#aaa8\",\r\n\r\n        gindicatorActive: \"#777\",\r\n        gindicatorActiveText: \"#aaa\",\r\n        gindicator: \"#333\",\r\n        gindicatorText: \"#555\",\r\n\r\n        guideActive: \"#f0f\",\r\n        guideGrid: \"#9992\"\r\n    }\r\n]\r\n\r\nexport function getThemeColor(colorName: string) {\r\n    const themeName = settings.theme\r\n    const theme = fteThemes.find(\r\n        t => t.theme === themeName\r\n    ) as any\r\n\r\n    return theme[colorName]\r\n}","import { accelStringToUserFriendly } from \"../utils/accelerator\"\r\nimport { ITool } from \"../viewport/tools/tool\"\r\n\r\nexport function setActiveTool(\r\n    index: number\r\n) {\r\n    const toolbar = document.querySelector(\"div.tools\")\r\n    toolbar.querySelector(\"button.active\").classList.remove(\"active\")\r\n\r\n    toolbar.children[index].classList.add(\"active\")\r\n}\r\n\r\nexport function prepareToolbar(\r\n    tools: ITool[],\r\n    defaultTool: ITool,\r\n    callback: (t: ITool) => void\r\n) {\r\n    const toolbar = document.querySelector(\"div.tools\")\r\n    toolbar.innerHTML = \"\"\r\n\r\n    tools.forEach(\r\n        tool => {\r\n            const button = document.createElement(\"button\")\r\n\r\n            button.title = `${tool.name} (${\r\n                accelStringToUserFriendly(tool.accelerator)\r\n            })`\r\n            button.innerHTML = `\r\n                <img src=\"res/icons/${tool.icon}.svg\">\r\n            `\r\n\r\n            if (tool === defaultTool)\r\n                button.classList.add(\"active\")\r\n\r\n            button.addEventListener(\"click\", () => {\r\n                toolbar.querySelector(\"button.active\").classList.remove(\r\n                    \"active\"\r\n                )\r\n\r\n                callback(tool)\r\n                button.classList.add(\"active\")\r\n            })\r\n\r\n            toolbar.appendChild(button)\r\n        }\r\n    )\r\n}","import { IContext } from \"../viewport/context/context\"\r\nimport { Viewport } from \"../viewport/viewport\"\r\n\r\nexport function setupViewport(context: IContext) {\r\n    const container = document.querySelector(\"div.viewport\")\r\n    \r\n    const prevViewport = container.querySelector(\"canvas\")\r\n    if (prevViewport) {\r\n        container.removeChild(prevViewport)\r\n    }\r\n\r\n    const viewport = new Viewport(\r\n        context, [], null\r\n    )\r\n    \r\n    container.appendChild(viewport.domCanvas)\r\n    \r\n    window.addEventListener(\"resize\", () => {\r\n        viewport.updateViewportSize()\r\n    })\r\n\r\n    return viewport\r\n}","import { IUndoableAction } from \"./action\"\r\n\r\nexport class ArrayAddAction<T> implements IUndoableAction {\r\n    constructor(\r\n        private target: T[],\r\n        private object: T,\r\n        private index: number\r\n    ) {}\r\n\r\n    undo() {\r\n        this.target.splice(this.index, 1)\r\n    }\r\n\r\n    redo() {\r\n        this.target.splice(this.index, 0, this.object)\r\n    }\r\n\r\n    finalize() {}\r\n\r\n    get valid() {\r\n        return this.index !== -1\r\n    }\r\n}\r\n\r\nexport class ArrayRemoveAction<T> implements IUndoableAction {\r\n    constructor(\r\n        private target: T[],\r\n        private object: T,\r\n        private index: number\r\n    ) {}\r\n\r\n    undo() {\r\n        this.target.splice(this.index, 0, this.object)\r\n    }\r\n\r\n    redo() {\r\n        this.target.splice(this.index, 1)\r\n    }\r\n\r\n    finalize() {}\r\n\r\n    get valid() {\r\n        return this.index !== -1\r\n    }\r\n}","import { EventEmitter } from \"events\"\r\nimport { IUndoableAction } from \"./action\"\r\n\r\ntype VCAObjectState = {\r\n    [key: string]: any\r\n}\r\n\r\nexport class ValueChangeAction implements IUndoableAction {\r\n    private beforeState: VCAObjectState = {}\r\n    private afterState: VCAObjectState = {}\r\n\r\n    constructor(\r\n        private target: any,\r\n        private keys: string[]\r\n    ) {\r\n        this.captureState(this.beforeState)\r\n    }\r\n\r\n    private captureState(stateTarget: VCAObjectState) {\r\n        this.keys.forEach(\r\n            key => stateTarget[key] = this.target[key]\r\n        )\r\n    }\r\n\r\n    undo() {\r\n        Object.assign(this.target, this.beforeState)\r\n        if (this.target instanceof EventEmitter)\r\n            this.target.emit(\"modified\")\r\n    }\r\n\r\n    redo() {\r\n        Object.assign(this.target, this.afterState)\r\n        if (this.target instanceof EventEmitter)\r\n            this.target.emit(\"modified\")\r\n    }\r\n\r\n    finalize() {\r\n        this.captureState(this.afterState)\r\n    }\r\n\r\n    get valid() {\r\n        return true\r\n    }\r\n}","import { IUndoableAction } from \"./actions/action\"\r\n\r\n\r\nexport class UndoContext {\r\n    public actions: IUndoableAction[] = []\r\n\r\n    public name: string = \"Unknown\"\r\n\r\n    addAction(...actions: IUndoableAction[]) {\r\n        this.actions.push(...actions)\r\n    }\r\n\r\n    undo() {\r\n        for (let i = this.actions.length - 1; i >= 0; i--) {\r\n            this.actions[i].undo()\r\n        }\r\n    }\r\n\r\n    redo() {\r\n        for (let i = 0; i < this.actions.length; i++) {\r\n            this.actions[i].redo()\r\n        }\r\n    }\r\n\r\n    finalize(name?: string) {\r\n        this.actions = this.actions.filter(a => a.valid)\r\n        this.actions.forEach(a => a.finalize())\r\n        if (name) this.name = name\r\n    }\r\n}","import { UndoContext } from \"./context\"\r\n\r\nlet undoContexts: UndoContext[] = []\r\nlet redoContexts: UndoContext[] = []\r\n\r\nexport let undoContext = new UndoContext()\r\n\r\nexport function finalizeUndoContext(name?: string) {\r\n    if (undoContext.actions.length) {\r\n        undoContext.finalize(name)\r\n        undoContexts.push(undoContext)\r\n\r\n        if (redoContexts.length)\r\n            redoContexts = []\r\n    }\r\n    undoContext = new UndoContext()\r\n}\r\n\r\nexport function canUndo() {\r\n    return undoContexts.length > 0\r\n}\r\n\r\nexport function canRedo() {\r\n    return redoContexts.length > 0\r\n}\r\n\r\nexport function undo() {\r\n    if (!canUndo()) return\r\n\r\n    const ctx = undoContexts.pop()\r\n    redoContexts.unshift(ctx)\r\n\r\n    ctx.undo()\r\n}\r\n\r\nexport function redo() {\r\n    if (!canRedo()) return\r\n\r\n    const ctx = redoContexts.shift()\r\n    undoContexts.push(ctx)\r\n\r\n    ctx.redo()\r\n}","export function accelStringToUserFriendly(str: string) {\r\n    return str.replace(\"^\", \"Ctrl-\")\r\n              .replace(\"+\", \"Shift-\")\r\n              .replace(\"!\", \"Alt-\")\r\n              .replace(\"Key\", \"\")\r\n}\r\n\r\nexport function accelStringToElectron(str: string) {\r\n    return str.replace(\"+\", \"Shift+\")\r\n              .replace(\"^\", \"CmdOrCtrl+\")\r\n              .replace(\"!\", \"Alt+\")\r\n              .replace(\"Key\", \"\")\r\n}","export function lerp(x: number, a: number, b: number) {\r\n    return a + x * (b - a)\r\n}\r\n\r\nexport function unlerp(X: number, a: number, b: number) {\r\n    if (a === b) return 0\r\n    return (X - a) / (b - a)\r\n}","import { Font } from \"../font/font\";\r\nimport { BezierCurve } from \"../geometry/bezier/curve\";\r\n\r\nconst previewStrings = [\r\n    \"Quick brown cat\",\r\n    \"General relativity\",\r\n    \"01123581321\",\r\n    \"Typography\",\r\n    \"Audiovisual\",\r\n    \"Another one bites the dust\"\r\n]\r\n\r\nexport function createFontPreview(font: Font) {\r\n    const canvas: HTMLCanvasElement = document.querySelector(\r\n        \"canvas.previewGenerator\"\r\n    )\r\n    const ctx = canvas.getContext(\"2d\")\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n\r\n    const testString = previewStrings[\r\n        Math.floor(previewStrings.length * Math.random())\r\n    ]\r\n\r\n    const glyphs = testString.split(\"\").map(\r\n        chr => font.glyphs.find(\r\n            g => g.codePoint === chr.codePointAt(0)\r\n        )\r\n    ).filter(g => g)\r\n\r\n    ctx.translate(0, 10)\r\n    ctx.scale(30 / 512, 30 / 512)\r\n\r\n    ctx.fillStyle = \"#000\"\r\n    glyphs.forEach(\r\n        g => {\r\n            const path = BezierCurve.getPath2D(\r\n                g.finalBeziers\r\n            )\r\n            ctx.fill(path)\r\n            ctx.translate(\r\n                g.metrics.rightBearing - g.metrics.leftBearing,\r\n                0\r\n            )\r\n        }\r\n    )\r\n\r\n    return canvas.toDataURL()\r\n}","import { BezierCurve } from \"../../geometry/bezier/curve\";\r\nimport { IDrawableHandle } from \"../drawable\";\r\nimport { IGuide } from \"../guides/guide\";\r\nimport { Viewport } from \"../viewport\";\r\nimport { IContext } from \"./context\";\r\n\r\nexport class BezierContext implements IContext {\r\n    public handles: IDrawableHandle[] = []\r\n    public guides: IGuide[] = []\r\n    public grids: IGuide[] = []\r\n\r\n    constructor(\r\n        public beziers: BezierCurve[]\r\n    ) {}\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        // Nothing tbh\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\";\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\";\r\nimport { setActiveGlyph } from \"../../ui/glyphList\";\r\nimport { getThemeColor } from \"../../ui/theme\";\r\nimport { CurveGuide } from \"../guides/curve\";\r\nimport { GridGuide } from \"../guides/grid\";\r\nimport { HorizontalGuide, VerticalGuide } from \"../guides/line\";\r\nimport { FontMetricHandle, FontMetricHandleType } from \"../handles/fontMetric\";\r\nimport { Viewport } from \"../viewport\";\r\nimport { BezierContext } from \"./bezier\";\r\n\r\nexport class GlyphContext extends BezierContext {\r\n    constructor(\r\n        public glyphs: Glyph[],\r\n        public currentIndex: number\r\n    ) {\r\n        super(glyphs[currentIndex].beziers)\r\n\r\n        this.setupHandlesAndGuides()\r\n        \r\n        setActiveGlyph(this.glyph)\r\n    }\r\n\r\n    get glyph() {\r\n        return this.glyphs[this.currentIndex]\r\n    }\r\n\r\n    setupHandlesAndGuides() {\r\n        this.handles = [\r\n            new FontMetricHandle(this.glyph, FontMetricHandleType.leftBearing),\r\n            new FontMetricHandle(this.glyph, FontMetricHandleType.rightBearing),\r\n            new FontMetricHandle(this.glyph, FontMetricHandleType.ascender),\r\n            new FontMetricHandle(this.glyph, FontMetricHandleType.descender),\r\n            new FontMetricHandle(this.glyph, FontMetricHandleType.xHeight)\r\n        ]\r\n\r\n        this.grids = [\r\n            new GridGuide()\r\n        ]\r\n        \r\n        this.guides = [\r\n            new HorizontalGuide(0),\r\n            new HorizontalGuide(512),\r\n            new HorizontalGuide(() => this.glyph.font.metrics.ascender, this.handles[2]),\r\n            new HorizontalGuide(() => this.glyph.font.metrics.descender, this.handles[3]),\r\n            new HorizontalGuide(() => this.glyph.font.metrics.xHeight, this.handles[4]),\r\n            new VerticalGuide(() => this.glyph.metrics.leftBearing, this.handles[0]),\r\n            new VerticalGuide(() => this.glyph.metrics.rightBearing, this.handles[1])\r\n        ]\r\n\r\n        this.beziers.forEach(\r\n            b => this.guides.push(\r\n                new CurveGuide(b)\r\n            )\r\n        )\r\n\r\n        // for (let bezier of this.beziers) {\r\n        //     for (let point of bezier.points) {\r\n        //         this.guides.push(\r\n        //             new PointGuide(point.base)\r\n        //         )\r\n        //     }\r\n        // }\r\n    }\r\n\r\n    setGlyphs(glyphs?: Glyph[], currentIndex?: number) {\r\n        if (glyphs)\r\n            this.glyphs = glyphs\r\n        \r\n        if (typeof currentIndex === \"number\")\r\n            this.currentIndex = currentIndex\r\n        else if (this.currentIndex >= this.glyphs.length)\r\n            this.currentIndex = this.glyphs.length - 1\r\n        \r\n        this.beziers = this.glyph.beziers\r\n        this.setupHandlesAndGuides()\r\n        \r\n        setActiveGlyph(this.glyph)\r\n    }\r\n\r\n    renderNonEditableGlyphs(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        let currentOffset = 0\r\n\r\n        if (this.currentIndex < this.glyphs.length - 1) {\r\n            for (let i = this.currentIndex + 1; i < this.glyphs.length; i++) {\r\n                const prevGlyph = this.glyphs[i - 1]\r\n                const glyph = this.glyphs[i]\r\n\r\n                const offset = prevGlyph.metrics.rightBearing -\r\n                               glyph.metrics.leftBearing\r\n\r\n                const path = BezierCurve.getPath2D(\r\n                    glyph.finalBeziers\r\n                )\r\n                \r\n                ctx.fillStyle = getThemeColor(\"glyphOtherFill\")\r\n                ctx.translate(offset, 0)\r\n                ctx.fill(path)\r\n\r\n                this.renderGlyphIndicator(v, ctx, glyph)\r\n\r\n                currentOffset += offset\r\n            }\r\n        }\r\n        ctx.translate(-currentOffset, 0)\r\n        currentOffset = 0\r\n\r\n        if (this.currentIndex > 0) {\r\n            for (let i = this.currentIndex - 1; i >= 0; i--) {\r\n                const nextGlyph = this.glyphs[i + 1]\r\n                const glyph = this.glyphs[i]\r\n\r\n                const offset = nextGlyph.metrics.leftBearing -\r\n                               glyph.metrics.rightBearing\r\n\r\n                const path = BezierCurve.getPath2D(\r\n                    glyph.finalBeziers\r\n                )\r\n                \r\n                ctx.fillStyle = getThemeColor(\"glyphOtherFill\")\r\n                ctx.translate(offset, 0)\r\n                ctx.fill(path)\r\n\r\n                this.renderGlyphIndicator(v, ctx, glyph)\r\n\r\n                currentOffset += offset\r\n\r\n            }\r\n        }\r\n        ctx.translate(-currentOffset, 0)\r\n        currentOffset = 0\r\n    }\r\n\r\n    renderGlyphIndicator(\r\n        v: Viewport, ctx: CanvasRenderingContext2D, glyph: Glyph\r\n    ) {\r\n        const x = glyph.metrics.leftBearing\r\n        const w = glyph.metrics.rightBearing - x\r\n        const y = glyph.font.metrics.ascender - 20 / v.co.scaleFactor\r\n\r\n        ctx.fillStyle = (this.glyph === glyph) ?\r\n                        getThemeColor(\"gindicatorActive\") :\r\n                        getThemeColor(\"gindicator\")\r\n        ctx.fillRect(x, y - 8 / v.co.scaleFactor, w, 8 / v.co.scaleFactor)\r\n\r\n        ctx.font = `400 ${20 / v.co.scaleFactor}px Inter`\r\n        ctx.textAlign = \"center\"\r\n        ctx.fillStyle = (this.glyph === glyph) ?\r\n                        getThemeColor(\"gindicatorActiveText\") :\r\n                        getThemeColor(\"gindicatorText\")\r\n        ctx.fillText(glyph.name, x + w / 2, y - 16 / v.co.scaleFactor)\r\n    }\r\n    \r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        this.renderNonEditableGlyphs(v, ctx)\r\n\r\n        // Glyph metric lines\r\n        ctx.strokeStyle = getThemeColor(\"glyphMetric\")\r\n        ctx.lineWidth = 1 / v.co.scaleFactor\r\n\r\n        ctx.beginPath()\r\n\r\n        ctx.moveTo(-9999, 512) // 512 is the bottom - baseline\r\n        ctx.lineTo(9999, 512)\r\n        \r\n        ctx.moveTo(-9999, 0) // 0 is the top - cap height\r\n        ctx.lineTo(9999, 0)\r\n        ctx.stroke()\r\n\r\n        ctx.setLineDash(\r\n            [10 / v.co.scaleFactor, 10 / v.co.scaleFactor]\r\n        )\r\n\r\n        // x-height\r\n        ctx.beginPath()\r\n        ctx.moveTo(-9999, this.glyph.font.metrics.xHeight)\r\n        ctx.lineTo(9999, this.glyph.font.metrics.xHeight)\r\n\r\n        // Ascender\r\n        ctx.moveTo(-9999, this.glyph.font.metrics.ascender)\r\n        ctx.lineTo(9999, this.glyph.font.metrics.ascender)\r\n\r\n        // Descender\r\n        ctx.moveTo(-9999, this.glyph.font.metrics.descender)\r\n        ctx.lineTo(9999, this.glyph.font.metrics.descender)\r\n\r\n        ctx.moveTo(this.glyph.metrics.leftBearing, -9999)\r\n        ctx.lineTo(this.glyph.metrics.leftBearing, 9999)\r\n\r\n        ctx.moveTo(this.glyph.metrics.rightBearing, -9999)\r\n        ctx.lineTo(this.glyph.metrics.rightBearing, 9999)\r\n\r\n        ctx.stroke()\r\n\r\n        // Glyph\r\n        const workingPath = BezierCurve.getPath2D(\r\n            this.glyph.beziers\r\n        )\r\n        const finalPath = BezierCurve.getPath2D(\r\n            this.glyph.finalBeziers\r\n        )\r\n\r\n        ctx.fillStyle = getThemeColor(\"glyphFill\")\r\n        ctx.fill(finalPath)\r\n        \r\n        ctx.setLineDash([])\r\n        ctx.strokeStyle = getThemeColor(\"glyphGapOutline\")\r\n        ctx.lineWidth = 4 / v.co.scaleFactor\r\n        ctx.stroke(workingPath)\r\n        ctx.strokeStyle = getThemeColor(\"glyphOutline\")\r\n        ctx.lineWidth = 1 / v.co.scaleFactor\r\n        ctx.stroke(workingPath)\r\n\r\n        this.renderGlyphIndicator(v, ctx, this.glyph)\r\n    }\r\n}","import { Point } from \"../geometry/point\"\r\n\r\nexport class ViewportCoordinates {\r\n    public dx = 0\r\n    public dy = 0\r\n    public scaleFactor = 1\r\n\r\n    // dx, dy in screen coordinates\r\n    translate(dx: number, dy: number) {\r\n        this.dx += dx\r\n        this.dy += dy\r\n    }\r\n\r\n    scale(factor: number, ox: number, oy: number) {\r\n        const newScale = this.scaleFactor * factor\r\n\r\n        this.dx = this.dx + this.scaleFactor * ox - newScale * ox\r\n        this.dy = this.dy + this.scaleFactor * oy - newScale * oy\r\n\r\n        this.scaleFactor = newScale\r\n    }\r\n\r\n    transformCanvas(ctx: CanvasRenderingContext2D) {\r\n        ctx.translate(this.dx, this.dy)\r\n        ctx.scale(this.scaleFactor, this.scaleFactor)\r\n    }\r\n\r\n    clientToWorld(x: number, y: number): Point {\r\n        return new Point(\r\n            (x - this.dx) / this.scaleFactor,\r\n            (y - this.dy) / this.scaleFactor\r\n        )\r\n    }\r\n\r\n    worldToClient(x: number, y: number) {\r\n        return {\r\n            x: x * this.scaleFactor + this.dx,\r\n            y: y * this.scaleFactor + this.dy\r\n        }\r\n    }\r\n\r\n    moveInClientDx(point: Point, dx: number, dy: number) {\r\n        const pos = this.worldToClient(point.x, point.y)\r\n        pos.x += dx\r\n        pos.y += dy\r\n\r\n        const {x, y} = this.clientToWorld(pos.x, pos.y)\r\n        point.x = x\r\n        point.y = y\r\n    }\r\n}","import { BezierCurve } from \"../../geometry/bezier/curve\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { BezierBasePointHandle } from \"../handles/bezierBasePoint\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { IGuide } from \"./guide\"\r\nimport paper from \"paper\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\n\r\nexport class CurveGuide implements IGuide {\r\n    public active = false\r\n    public worldRender = true\r\n\r\n    constructor(\r\n        public source: BezierCurve\r\n    ) { }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        if (\r\n            obj instanceof BezierBasePointHandle &&\r\n            obj.point.curve === this.source\r\n        )\r\n            return null\r\n\r\n        const paperPath = this.source.getPaperPath()\r\n        const paperPoint = new paper.Point(pos.x, pos.y)\r\n\r\n        const nearest = paperPath.getNearestPoint(paperPoint)\r\n        if (!nearest) {\r\n            this.active = false\r\n            return null\r\n        }\r\n\r\n        const clientPos = v.co.worldToClient(pos.x, pos.y)\r\n        const clientTarget = v.co.worldToClient(\r\n            nearest.x, nearest.y\r\n        )\r\n\r\n        if (Math.hypot(\r\n            clientPos.x - clientTarget.x,\r\n            clientPos.y - clientTarget.y\r\n        ) < 10) {\r\n            this.active = true\r\n\r\n            return new Point(\r\n                nearest.x, nearest.y\r\n            )\r\n        } else {\r\n            this.active = false\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const path = BezierCurve.getPath2D([this.source])\r\n\r\n        ctx.lineWidth = 1 / v.co.scaleFactor\r\n        ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n        ctx.stroke(path)\r\n    }\r\n}","import { currentFont } from \"../../app\";\r\nimport { Point } from \"../../geometry/point\";\r\nimport { getThemeColor } from \"../../ui/theme\";\r\nimport { Viewport } from \"../viewport\";\r\nimport { IGuide } from \"./guide\";\r\n\r\nexport class GridGuide implements IGuide {\r\n    public active = false\r\n    private lastPoint = new Point(\r\n        -100000, -100000\r\n    )\r\n\r\n    private get baseGap(): number {\r\n        return currentFont.settings.gridMainGap\r\n    }\r\n\r\n    calculateGap(v: Viewport) {\r\n        let clientGap = this.baseGap * v.co.scaleFactor\r\n\r\n        while (clientGap < 12) {\r\n            clientGap *= 2\r\n        }\r\n\r\n        return clientGap / v.co.scaleFactor\r\n    }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        const gap = this.calculateGap(v)\r\n\r\n        const target = new Point(\r\n            Math.round(pos.x / gap) * gap,\r\n            Math.round(pos.y / gap) * gap\r\n        )\r\n        const delta = 8 / v.co.scaleFactor\r\n\r\n        this.active = false\r\n\r\n        this.lastPoint.x = NaN\r\n        this.lastPoint.y = NaN\r\n\r\n        if (Math.abs(pos.x - target.x) < delta) {\r\n            this.lastPoint.x = target.x\r\n            this.active = true\r\n        }\r\n        if (Math.abs(pos.y - target.y) < delta) {\r\n            this.lastPoint.y = target.y\r\n            this.active = true\r\n        }\r\n\r\n        if (this.active) {\r\n            return new Point(\r\n                isNaN(this.lastPoint.x) ? pos.x : target.x,\r\n                isNaN(this.lastPoint.y) ? pos.y : target.y\r\n            )\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const gap = this.calculateGap(v)\r\n\r\n        const minXY = v.co.clientToWorld(0, 0)\r\n        const maxXY = v.co.clientToWorld(\r\n            v.domCanvas.width, v.domCanvas.height\r\n        )\r\n\r\n        minXY.x = Math.round(minXY.x / gap) * gap\r\n        minXY.y = Math.round(minXY.y / gap) * gap\r\n        maxXY.x = Math.round(maxXY.x / gap) * gap\r\n        maxXY.y = Math.round(maxXY.y / gap) * gap\r\n\r\n        ctx.lineWidth = 1\r\n\r\n        for (let x = minXY.x; x <= maxXY.x; x += gap) {\r\n            const client = v.co.worldToClient(x, 0)\r\n\r\n            ctx.beginPath()\r\n            ctx.moveTo(Math.round(client.x) + 0.5, -9999)\r\n            ctx.lineTo(Math.round(client.x) + 0.5, 9999)\r\n            ctx.strokeStyle = getThemeColor(\"guideGrid\")\r\n\r\n            if (\r\n                this.active && this.lastPoint.x === x\r\n            )\r\n                ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n\r\n            ctx.stroke()\r\n        }\r\n        for (let y = minXY.y; y <= maxXY.y; y += gap) {\r\n            const client = v.co.worldToClient(0, y)\r\n\r\n            ctx.beginPath()\r\n            ctx.moveTo(-9999, Math.round(client.y) + 0.5)\r\n            ctx.lineTo(9999, Math.round(client.y) + 0.5)\r\n            ctx.strokeStyle = getThemeColor(\"guideGrid\")\r\n\r\n            if (\r\n                this.active && this.lastPoint.y === y\r\n            )\r\n                ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n\r\n            ctx.stroke()\r\n        }\r\n        \r\n    }\r\n}","import { Point } from \"../../geometry/point\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { IGuide } from \"./guide\"\r\n\r\nexport class HorizontalGuide implements IGuide {\r\n    public active = false\r\n\r\n    constructor(\r\n        private valueHandler: number | (() => number),\r\n        public source?: any\r\n    ) { }\r\n\r\n    get value() {\r\n        if (this.valueHandler instanceof Function)\r\n            return this.valueHandler()\r\n\r\n        return this.valueHandler\r\n    }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        if (obj && this.source && obj === this.source) {\r\n            this.active = false\r\n            return null\r\n        }\r\n\r\n        const clientPos = v.co.worldToClient(pos.x, pos.y)\r\n        const clientTarget = v.co.worldToClient(pos.x, this.value)\r\n\r\n        if (Math.abs(clientPos.y - clientTarget.y) < 8) {\r\n            this.active = true\r\n            return new Point(pos.x, this.value)\r\n        } else {\r\n            this.active = false\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const clientPos = v.co.worldToClient(\r\n            0, this.value\r\n        )\r\n        clientPos.y = Math.round(clientPos.y) + 0.5\r\n\r\n        ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n        ctx.lineWidth = 1\r\n\r\n        ctx.beginPath()\r\n        ctx.moveTo(-9999, clientPos.y)\r\n        ctx.lineTo(9999, clientPos.y)\r\n        ctx.stroke()\r\n    }\r\n}\r\n\r\nexport class VerticalGuide implements IGuide {\r\n    public active = false\r\n\r\n    constructor(\r\n        private valueHandler: number | (() => number),\r\n        public source?: any\r\n    ) { }\r\n\r\n    get value() {\r\n        if (this.valueHandler instanceof Function)\r\n            return this.valueHandler()\r\n\r\n        return this.valueHandler\r\n    }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        if (obj && this.source && obj === this.source) {\r\n            this.active = false\r\n            return null\r\n        }\r\n\r\n        const clientPos = v.co.worldToClient(pos.x, pos.y)\r\n        const clientTarget = v.co.worldToClient(this.value, pos.y)\r\n\r\n        if (Math.abs(clientPos.x - clientTarget.x) < 8) {\r\n            this.active = true\r\n            return new Point(this.value, pos.y)\r\n        } else {\r\n            this.active = false\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const clientPos = v.co.worldToClient(\r\n            this.value, 0\r\n        )\r\n        clientPos.x = Math.round(clientPos.x) + 0.5\r\n\r\n        ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n        ctx.lineWidth = 1\r\n\r\n        ctx.beginPath()\r\n        ctx.moveTo(clientPos.x, -9999)\r\n        ctx.lineTo(clientPos.x, 9999)\r\n        ctx.stroke()\r\n    }\r\n}\r\n","import { Point } from \"../../geometry/point\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { IGuide } from \"./guide\"\r\n\r\nexport class PointGuide implements IGuide {\r\n    public active = false\r\n\r\n    constructor(\r\n        public source: Point\r\n    ) { }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        if (\r\n            obj && this.source &&\r\n            (\r\n                obj === this.source ||\r\n                (\r\n                    \"position\" in obj &&\r\n                    obj.position === this.source\r\n                )\r\n            )\r\n        ) {\r\n            this.active = false\r\n            return\r\n        }\r\n\r\n        const clientPos = v.co.worldToClient(pos.x, pos.y)\r\n        const clientTarget = v.co.worldToClient(\r\n            this.source.x, this.source.y\r\n        )\r\n\r\n        if (Math.hypot(\r\n            clientPos.x - clientTarget.x,\r\n            clientPos.y - clientTarget.y\r\n        ) < 10) {\r\n            this.active = true\r\n            return new Point(this.source.x, this.source.y)\r\n        } else {\r\n            this.active = false\r\n            return null\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const clientPos = v.co.worldToClient(\r\n            this.source.x, this.source.y\r\n        )\r\n        clientPos.x = Math.round(clientPos.x) + 0.5\r\n        clientPos.y = Math.round(clientPos.y) + 0.5\r\n\r\n        ctx.strokeStyle = getThemeColor(\"guideActive\")\r\n        ctx.lineWidth = 1\r\n\r\n        ctx.beginPath()\r\n        ctx.moveTo(clientPos.x - 16, clientPos.y)\r\n        ctx.lineTo(clientPos.x + 16, clientPos.y)\r\n        ctx.moveTo(clientPos.x, clientPos.y - 16)\r\n        ctx.lineTo(clientPos.x, clientPos.y + 16)\r\n        ctx.stroke()\r\n    }\r\n}\r\n\r\nexport class HandleGuide extends PointGuide {\r\n    constructor(\r\n        public handle: IDrawableHandle\r\n    ) {\r\n        super(handle.position)\r\n    }\r\n\r\n    nudge(v: Viewport, pos: Point, obj?: any) {\r\n        if (\r\n            this.handle.selected ||\r\n            this.handle === obj\r\n        ) return null\r\n        return super.nudge(v, pos, obj)\r\n    }\r\n}","import { BezierPoint, BezierPointType } from \"../../geometry/bezier/point\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { UndoContext } from \"../../undo/context\"\r\nimport { ValueChangeAction } from \"../../undo/actions/value\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\n\r\nexport class BezierBasePointHandle implements IDrawableHandle {\r\n    public hitRadius = 10\r\n    public selected = false\r\n    public type = \"BezierBasePointHandle\"\r\n    \r\n    constructor(\r\n        public point: BezierPoint\r\n    ) {}\r\n\r\n    get position() {\r\n        return this.point.base\r\n    }\r\n\r\n    move(\r\n        v: Viewport, pos: Point, dPos: Point,\r\n        pivot: IDrawableHandle,\r\n        e?: MouseEvent\r\n    ) {\r\n        this.point.movePoint(this.point.base, dPos)\r\n    }\r\n\r\n    prepareUndo(uc: UndoContext) {\r\n        uc.addAction(\r\n            new ValueChangeAction(this.point.base, [\"x\", \"y\"]),\r\n            new ValueChangeAction(this.point.before, [\"x\", \"y\"]),\r\n            new ValueChangeAction(this.point.after, [\"x\", \"y\"])\r\n        )\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const angle = this.point.after.angle(\r\n            this.point.base\r\n        )\r\n\r\n        ctx.beginPath()\r\n        switch (this.point.type) {\r\n            case BezierPointType.auto:\r\n                ctx.moveTo(\r\n                    5 * Math.cos(angle),\r\n                    5 * Math.sin(angle)\r\n                )\r\n                ctx.lineTo(\r\n                    5 * Math.cos(angle + Math.PI / 2),\r\n                    5 * Math.sin(angle + Math.PI / 2)\r\n                )\r\n                ctx.lineTo(\r\n                    5 * Math.cos(angle + Math.PI),\r\n                    5 * Math.sin(angle + Math.PI)\r\n                )\r\n                ctx.lineTo(\r\n                    5 * Math.cos(angle + 3 * Math.PI / 2),\r\n                    5 * Math.sin(angle + 3 * Math.PI / 2)\r\n                )\r\n                break\r\n            case BezierPointType.sharp:\r\n                ctx.rect(-4, -4, 8, 8)\r\n                break\r\n            default:\r\n                ctx.arc(0, 0, 5, 0, Math.PI * 2)\r\n        }\r\n        ctx.closePath()\r\n\r\n        ctx.fillStyle = this.selected ?\r\n                        getThemeColor(\"handleSelected\") :\r\n                        getThemeColor(\"handleFill\")\r\n        ctx.strokeStyle = getThemeColor(\"handleSelected\")\r\n        ctx.lineWidth = 1\r\n        ctx.fill()\r\n        ctx.stroke()\r\n    }\r\n}","import { BezierPoint, BezierPointType } from \"../../geometry/bezier/point\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { UndoContext } from \"../../undo/context\"\r\nimport { ValueChangeAction } from \"../../undo/actions/value\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\n\r\nexport class BezierControlPointHandle implements IDrawableHandle {\r\n    public hitRadius = 6\r\n    public selected = false\r\n    public type = \"BezierControlPointHandle\"\r\n    public hidden = false\r\n    \r\n    constructor(\r\n        public point: BezierPoint,\r\n        private cpoint: Point\r\n    ) {}\r\n\r\n    get position() {\r\n        return this.cpoint\r\n    }\r\n\r\n    move(\r\n        v: Viewport, pos: Point, dPos: Point,\r\n        pivot: IDrawableHandle,\r\n        e?: MouseEvent\r\n    ) {\r\n        // let forceType = null\r\n        // if (\r\n        //     this.point.type !== BezierPointType.free &&\r\n        //     e.altKey\r\n        // )\r\n        //     forceType = BezierPointType.free\r\n\r\n        this.point.movePoint(this.cpoint, dPos)\r\n    }\r\n\r\n    prepareUndo(uc: UndoContext) {\r\n        uc.addAction(\r\n            new ValueChangeAction(this.point.base, [\"x\", \"y\"]),\r\n            new ValueChangeAction(this.point.before, [\"x\", \"y\"]),\r\n            new ValueChangeAction(this.point.after, [\"x\", \"y\"])\r\n        )\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        const basePos = v.co.worldToClient(\r\n            this.point.base.x, this.point.base.y\r\n        )\r\n        const ctrlPos = v.co.worldToClient(\r\n            this.cpoint.x, this.cpoint.y\r\n        )\r\n\r\n        const distance = Math.hypot(\r\n            basePos.x - ctrlPos.x,\r\n            basePos.y - ctrlPos.y\r\n        )\r\n        this.hidden = distance <= 8\r\n        if (this.hidden) return\r\n        \r\n        ctx.strokeStyle = getThemeColor(\"handleControlArm\")\r\n        ctx.lineWidth = 1\r\n        ctx.beginPath()\r\n        ctx.moveTo(\r\n            basePos.x - ctrlPos.x,\r\n            basePos.y - ctrlPos.y\r\n        )\r\n        ctx.lineTo(0, 0)\r\n        ctx.stroke()\r\n\r\n        ctx.fillStyle = this.selected ? \r\n                        getThemeColor(\"handleSelected\") :\r\n                        getThemeColor(\"handleControlFill\")\r\n        ctx.beginPath()\r\n        ctx.arc(0, 0, 3, 0, 2 * Math.PI)\r\n        ctx.fill()\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { UndoContext } from \"../../undo/context\"\r\nimport { ValueChangeAction } from \"../../undo/actions/value\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { getThemeColor } from \"../../ui/theme\"\r\n\r\nexport enum FontMetricHandleType {\r\n    leftBearing, rightBearing,\r\n    ascender, descender, xHeight\r\n}\r\n\r\nenum FontMetricHandleDir {\r\n    horz, vert\r\n}\r\n\r\nexport class FontMetricHandle implements IDrawableHandle {\r\n    public hitRadius = 10\r\n    public selected = false\r\n    public type = \"FontMetricHandle\"\r\n\r\n    private dir = FontMetricHandleDir.horz\r\n    \r\n    constructor(\r\n        private glyph: Glyph,\r\n        private metric: FontMetricHandleType\r\n    ) {\r\n        if (\r\n            metric === FontMetricHandleType.leftBearing ||\r\n            metric === FontMetricHandleType.rightBearing\r\n        )\r\n            this.dir = FontMetricHandleDir.vert\r\n    }\r\n\r\n    prepareUndo(uc: UndoContext) {\r\n        let action = null\r\n\r\n        switch (this.metric) {\r\n            case FontMetricHandleType.ascender:\r\n                action = new ValueChangeAction(this.glyph.font.metrics, [\"ascender\"])\r\n                break\r\n            case FontMetricHandleType.descender:\r\n                action = new ValueChangeAction(this.glyph.font.metrics, [\"descender\"])\r\n                break\r\n            case FontMetricHandleType.xHeight:\r\n                action = new ValueChangeAction(this.glyph.font.metrics, [\"xHeight\"])\r\n                break\r\n            \r\n            case FontMetricHandleType.leftBearing:\r\n                action = new ValueChangeAction(this.glyph.metrics, [\"leftBearing\"])\r\n                break\r\n            case FontMetricHandleType.rightBearing:\r\n                action = new ValueChangeAction(this.glyph.metrics, [\"rightBearing\"])\r\n                break\r\n        }\r\n\r\n        if (action) uc.addAction(action)\r\n    }\r\n\r\n    private get value() {\r\n        switch (this.metric) {\r\n            case FontMetricHandleType.ascender:\r\n                return this.glyph.font.metrics.ascender\r\n            case FontMetricHandleType.descender:\r\n                return this.glyph.font.metrics.descender\r\n            case FontMetricHandleType.xHeight:\r\n                return this.glyph.font.metrics.xHeight\r\n            \r\n            case FontMetricHandleType.leftBearing:\r\n                return this.glyph.metrics.leftBearing\r\n            case FontMetricHandleType.rightBearing:\r\n                return this.glyph.metrics.rightBearing\r\n        }\r\n\r\n        return 0\r\n    }\r\n\r\n    private set value(x: number) {\r\n        switch (this.metric) {\r\n            case FontMetricHandleType.ascender:\r\n                this.glyph.font.metrics.ascender = Math.min(x, 0)\r\n                break\r\n            case FontMetricHandleType.descender:\r\n                this.glyph.font.metrics.descender = Math.max(x, 512)\r\n                break\r\n            case FontMetricHandleType.xHeight:\r\n                this.glyph.font.metrics.xHeight = Math.max(Math.min(x, 512), 0)\r\n                break\r\n            \r\n            case FontMetricHandleType.leftBearing:\r\n                this.glyph.metrics.leftBearing = x\r\n                break\r\n            case FontMetricHandleType.rightBearing:\r\n                this.glyph.metrics.rightBearing = x\r\n                break\r\n        }\r\n\r\n        this.glyph.emit(\"modified\")\r\n    }\r\n\r\n    get position() {\r\n        if (this.dir === FontMetricHandleDir.horz)\r\n            return new Point(-20, this.value)\r\n        \r\n        return new Point(this.value, 532)\r\n    }\r\n\r\n    move(\r\n        v: Viewport, pos: Point, dPos: Point,\r\n        pivot: IDrawableHandle,\r\n        e?: MouseEvent\r\n    ) {\r\n        if (this.dir === FontMetricHandleDir.horz) {\r\n            this.value = pos.y\r\n        } else {\r\n            this.value = pos.x\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        ctx.beginPath()\r\n        ctx.arc(0, 0, 5, 0, 2 * Math.PI)\r\n        ctx.moveTo(0, 0)\r\n\r\n        if (this.dir === FontMetricHandleDir.horz)\r\n            ctx.lineTo(20 * v.co.scaleFactor, 0)\r\n        else\r\n            ctx.lineTo(0, -20 * v.co.scaleFactor)\r\n\r\n        ctx.fillStyle = this.selected ?\r\n                        getThemeColor(\"handleSelected\") :\r\n                        getThemeColor(\"handleMetricFill\")\r\n        ctx.strokeStyle = getThemeColor(\"handleSelected\")\r\n        ctx.lineWidth = 1\r\n        ctx.setLineDash([])\r\n        ctx.stroke()\r\n        ctx.fill()\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\"\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\"\r\nimport { BezierPoint, BezierPointType } from \"../../geometry/bezier/point\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { ArrayAddAction, ArrayRemoveAction } from \"../../undo/actions/array\"\r\nimport { ValueChangeAction } from \"../../undo/actions/value\"\r\nimport { finalizeUndoContext, undoContext } from \"../../undo/history\"\r\nimport { BezierContext } from \"../context/bezier\"\r\nimport { IContext } from \"../context/context\"\r\nimport { GlyphContext } from \"../context/glyph\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { IGuide } from \"../guides/guide\"\r\nimport { PointGuide } from \"../guides/point\"\r\nimport { BezierBasePointHandle } from \"../handles/bezierBasePoint\"\r\nimport { BezierControlPointHandle } from \"../handles/bezierControlPoint\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { ITool, ToolSubAction, ToolSubActionSection } from \"./tool\"\r\n\r\nexport class BezierPenTool implements ITool {\r\n    public name = \"Pen\"\r\n    public icon = \"beziertool\"\r\n    public accelerator = \"KeyB\"\r\n\r\n    private currentBezier: BezierCurve = null\r\n    private finalAdjustmentStage = false\r\n\r\n    public handles: IDrawableHandle[] = []\r\n    public guides: IGuide[] = []\r\n    public supportsForeignHandles = false\r\n\r\n    public subactions: ToolSubActionSection[] = [\r\n        {\r\n            name: \"Edit\",\r\n            subactions: [\r\n                {\r\n                    name: \"Delete last point\",\r\n                    icon: \"delete\",\r\n                    accelerator: \"Delete\",\r\n                    handler: () => {\r\n                        if (!this.currentBezier) return\r\n    \r\n                        const idx = this.currentBezier.points.length - 1\r\n                        const point = this.currentBezier.points[\r\n                            idx\r\n                        ]\r\n                        this.currentBezier.points.splice(idx, 1)\r\n                        undoContext.addAction(\r\n                            new ArrayRemoveAction(\r\n                                this.currentBezier.points, point,\r\n                                idx\r\n                            )\r\n                        )\r\n    \r\n                        const cpHandles = this.handles.filter(\r\n                            h => h instanceof BezierControlPointHandle &&\r\n                                 h.point === point\r\n                        ) // length always = 2\r\n    \r\n                        const hIndex = this.handles.findIndex(\r\n                            h => h instanceof BezierBasePointHandle &&\r\n                                 h.point == point\r\n                        )\r\n                        this.handles.splice(hIndex, 1)\r\n    \r\n                        const cpIndex0 = this.handles.indexOf(cpHandles[0])\r\n                        this.handles.splice(cpIndex0, 1)\r\n    \r\n                        const cpIndex1 = this.handles.indexOf(cpHandles[1])\r\n                        this.handles.splice(cpIndex1, 1)\r\n    \r\n                        \r\n                        undoContext.addAction(\r\n                            new ArrayRemoveAction(\r\n                                this.handles, this.handles[hIndex],\r\n                                hIndex\r\n                            ),\r\n                            new ArrayRemoveAction(\r\n                                this.handles, this.handles[cpIndex0],\r\n                                cpIndex0\r\n                            ),\r\n                            new ArrayRemoveAction(\r\n                                this.handles, this.handles[cpIndex1],\r\n                                cpIndex1\r\n                            )\r\n                        )\r\n    \r\n                        if (!this.currentBezier.points.length) {\r\n                            const bIdx = this.glyph.beziers.indexOf(\r\n                                this.currentBezier\r\n                            )\r\n                            this.glyph.beziers.splice(bIdx, 1)\r\n                            this.currentBezier = null\r\n    \r\n                            undoContext.addAction(\r\n                                new ArrayRemoveAction(\r\n                                    this.glyph.beziers, this.currentBezier,\r\n                                    bIdx\r\n                                )\r\n                            )\r\n                        }\r\n    \r\n                        finalizeUndoContext(\"Delete last point\")\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n\r\n    private glyph: Glyph\r\n\r\n    get currentPoint(): BezierPoint {\r\n        if (!this.currentBezier) return null\r\n\r\n        if (this.finalAdjustmentStage)\r\n            return this.currentBezier.points[0]\r\n\r\n        return this.currentBezier.points[\r\n            this.currentBezier.points.length - 1\r\n        ]\r\n    }\r\n\r\n    handleMouseEvent(v: Viewport, e: MouseEvent, x: number, y: number) {\r\n        if (!(v.context instanceof BezierContext)) return\r\n\r\n        const pos = v.co.clientToWorld(\r\n            x, y\r\n        )\r\n        const rawPos = new Point()\r\n        rawPos.copy(pos)\r\n\r\n        if (this.currentBezier && this.currentBezier.points.length) {\r\n            v.restrictAngles(\r\n                this.currentBezier.points[\r\n                    this.currentBezier.points.length - 1\r\n                ].base,\r\n                pos,\r\n                e\r\n            )\r\n        }\r\n\r\n        v.nudgePoint(pos)\r\n\r\n        if (\r\n            e.type === \"mousedown\" && e.buttons & 1\r\n        ) {\r\n            if (!this.currentBezier) {\r\n                this.currentBezier = new BezierCurve(this.glyph)\r\n                const length = v.context.beziers.push(\r\n                    this.currentBezier\r\n                )\r\n\r\n                undoContext.addAction(\r\n                    new ArrayAddAction(\r\n                        v.context.beziers,\r\n                        this.currentBezier,\r\n                        length - 1\r\n                    )\r\n                )\r\n            }\r\n\r\n            let nearHandle = v.nearHandle(\r\n                pos.x, pos.y, \"BezierBasePointHandle\"\r\n            )\r\n            if (\r\n                this.currentBezier && this.currentBezier.points.length\r\n            ) {\r\n                const rawNearHandle = v.nearHandle(\r\n                    rawPos.x, rawPos.y, \"BezierBasePointHandle\"\r\n                )\r\n                if (\r\n                    rawNearHandle &&\r\n                    nearHandle instanceof BezierBasePointHandle &&\r\n                    nearHandle.position === this.currentBezier.points[0].base\r\n                )\r\n                    nearHandle = rawNearHandle\r\n            }\r\n\r\n            if (\r\n                nearHandle &&\r\n                nearHandle instanceof BezierBasePointHandle &&\r\n                nearHandle.position === this.currentBezier.points[0].base\r\n            ) {\r\n                // Forget the curve, but allow last adjustments\r\n                this.finalAdjustmentStage = true\r\n                undoContext.addAction(\r\n                    new ValueChangeAction(\r\n                        this.currentPoint.base, [\"x\", \"y\"]\r\n                    ),\r\n                    new ValueChangeAction(\r\n                        this.currentPoint.before, [\"x\", \"y\"]\r\n                    ),\r\n                    new ValueChangeAction(\r\n                        this.currentPoint.after, [\"x\", \"y\"]\r\n                    )\r\n                )\r\n            } else {\r\n                // Add a point\r\n                const point = new BezierPoint(\r\n                    new Point(pos.x, pos.y),\r\n                    new Point(pos.x, pos.y),\r\n                    new Point(pos.x, pos.y)\r\n                )\r\n                this.currentBezier.addPoint(point)\r\n                undoContext.addAction(\r\n                    new ArrayAddAction(\r\n                        this.currentBezier.points,\r\n                        point,\r\n                        this.currentBezier.points.length - 1\r\n                    )\r\n                )\r\n\r\n                const length = this.handles.push(\r\n                    new BezierControlPointHandle(point, point.before),\r\n                    new BezierControlPointHandle(point, point.after),\r\n                    new BezierBasePointHandle(point)\r\n                )\r\n                undoContext.addAction(\r\n                    new ArrayAddAction(\r\n                        this.handles,\r\n                        this.handles[length - 3],\r\n                        length - 3\r\n                    ),\r\n                    new ArrayAddAction(\r\n                        this.handles,\r\n                        this.handles[length - 2],\r\n                        length - 2\r\n                    ),\r\n                    new ArrayAddAction(\r\n                        this.handles,\r\n                        this.handles[length - 1],\r\n                        length - 1\r\n                    )\r\n                )\r\n            }\r\n        } else if (\r\n            e.type === \"mousemove\" && e.buttons & 1 &&\r\n            this.currentPoint\r\n        ) {\r\n            this.currentPoint.after.x = pos.x\r\n            this.currentPoint.after.y = pos.y\r\n\r\n            if (!e.altKey) {\r\n                this.currentPoint.type = BezierPointType.auto\r\n                this.currentPoint.before.x = 2 * this.currentPoint.base.x - pos.x\r\n                this.currentPoint.before.y = 2 * this.currentPoint.base.y - pos.y\r\n            } else {\r\n                this.currentPoint.type = BezierPointType.free\r\n            }\r\n        } else if (\r\n            e.type === \"mouseup\"\r\n        ) {\r\n            if (this.finalAdjustmentStage) {\r\n                this.handles = []\r\n                this.currentBezier.points[0].determineType()\r\n                this.currentBezier = null\r\n\r\n                finalizeUndoContext(\"Close curve\")\r\n            } else if (this.currentBezier && this.currentBezier.points.length === 1) {\r\n                finalizeUndoContext(\"Create curve\")\r\n            } else {\r\n                this.currentPoint.determineType()\r\n                finalizeUndoContext(\"Add point\")\r\n            }\r\n            this.finalAdjustmentStage = false\r\n            \r\n            this.glyph.emit(\"modified\")\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n    }\r\n\r\n    updateContext(context: IContext) {\r\n        if (!(context instanceof GlyphContext)) return\r\n\r\n        this.glyph = context.glyph\r\n\r\n        this.handles = []\r\n        this.guides = []\r\n\r\n        this.currentBezier = null\r\n        \r\n        for (let bezier of context.beziers) {\r\n            for (let point of bezier.points) {\r\n                this.guides.push(\r\n                    new PointGuide(point.base)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\"\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\"\r\nimport { BezierPoint } from \"../../geometry/bezier/point\"\r\nimport { Point } from \"../../geometry/point\"\r\nimport { ArrayAddAction } from \"../../undo/actions/array\"\r\nimport { finalizeUndoContext, undoContext } from \"../../undo/history\"\r\nimport { lerp } from \"../../utils/lerp\"\r\nimport { BezierContext } from \"../context/bezier\"\r\nimport { IContext } from \"../context/context\"\r\nimport { GlyphContext } from \"../context/glyph\"\r\nimport { IDrawableHandle } from \"../drawable\"\r\nimport { IGuide } from \"../guides/guide\"\r\nimport { PointGuide } from \"../guides/point\"\r\nimport { Viewport } from \"../viewport\"\r\nimport { ITool, ToolSubAction, ToolSubActionSection } from \"./tool\"\r\n\r\n// ~ magic number ~\r\nconst magic = 4 * (Math.SQRT2 - 1) / 3\r\n\r\nexport class EllipseTool implements ITool {\r\n    public name = \"Ellipse\"\r\n    public icon = \"ellipsetool\"\r\n    public accelerator = \"KeyE\"\r\n\r\n    public handles: IDrawableHandle[] = []\r\n    public guides: IGuide[] = []\r\n    public supportsForeignHandles = false\r\n\r\n    public subactions: ToolSubActionSection[] = []\r\n\r\n    private startPoint: Point\r\n\r\n    private glyph: Glyph\r\n\r\n    private currentBezier: BezierCurve\r\n\r\n    createEllipse(): BezierCurve {\r\n        const curve = new BezierCurve(this.glyph)\r\n\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n\r\n        return curve\r\n    }\r\n\r\n    updateEllipse(pos: Point, e: MouseEvent) {\r\n        const origin = new Point(\r\n            this.startPoint.x, this.startPoint.y\r\n        )\r\n        let radius = Math.abs(pos.y - origin.y)\r\n        let scale = Math.abs(\r\n            (pos.x - origin.x) / (pos.y - origin.y)\r\n        )\r\n\r\n        if (e.shiftKey) {\r\n            radius = Math.max(\r\n                radius, Math.abs(pos.x - origin.x)\r\n            )\r\n            scale = 1\r\n        }\r\n        if (!e.ctrlKey) {\r\n            radius /= 2\r\n            origin.x += radius * scale * Math.sign(pos.x - origin.x)\r\n            origin.y += radius * Math.sign(pos.y - origin.y)\r\n        }\r\n\r\n        this.currentBezier.points[0].base.x = origin.x\r\n        this.currentBezier.points[0].base.y = origin.y - radius\r\n        this.currentBezier.points[0].before.x = origin.x - magic * radius * scale\r\n        this.currentBezier.points[0].before.y = origin.y - radius\r\n        this.currentBezier.points[0].after.x = origin.x + magic * radius * scale\r\n        this.currentBezier.points[0].after.y = origin.y - radius\r\n\r\n        this.currentBezier.points[1].base.x = origin.x + radius * scale\r\n        this.currentBezier.points[1].base.y = origin.y\r\n        this.currentBezier.points[1].before.x = origin.x + radius * scale\r\n        this.currentBezier.points[1].before.y = origin.y - magic * radius\r\n        this.currentBezier.points[1].after.x = origin.x + radius * scale\r\n        this.currentBezier.points[1].after.y = origin.y + magic * radius\r\n\r\n        this.currentBezier.points[2].base.x = origin.x\r\n        this.currentBezier.points[2].base.y = origin.y + radius\r\n        this.currentBezier.points[2].before.x = origin.x + magic * radius * scale\r\n        this.currentBezier.points[2].before.y = origin.y + radius\r\n        this.currentBezier.points[2].after.x = origin.x - magic * radius * scale\r\n        this.currentBezier.points[2].after.y = origin.y + radius\r\n\r\n        this.currentBezier.points[3].base.x = origin.x - radius * scale\r\n        this.currentBezier.points[3].base.y = origin.y\r\n        this.currentBezier.points[3].before.x = origin.x - radius * scale\r\n        this.currentBezier.points[3].before.y = origin.y + magic * radius\r\n        this.currentBezier.points[3].after.x = origin.x - radius * scale\r\n        this.currentBezier.points[3].after.y = origin.y - magic * radius\r\n    }\r\n    \r\n    handleMouseEvent(\r\n        v: Viewport, e: MouseEvent, x: number, y: number\r\n    ) {\r\n        if (!(v.context instanceof BezierContext)) return\r\n\r\n        const pos = v.co.clientToWorld(\r\n            x, y\r\n        )\r\n        v.nudgePoint(pos)\r\n\r\n        if (\r\n            e.type === \"mousedown\" && e.buttons & 1\r\n        ) {\r\n            this.currentBezier = this.createEllipse()\r\n            this.startPoint = pos\r\n\r\n            this.updateEllipse(pos, e)\r\n\r\n            v.context.beziers.push(this.currentBezier)\r\n            \r\n            undoContext.addAction(\r\n                new ArrayAddAction(\r\n                    v.context.beziers, this.currentBezier,\r\n                    v.context.beziers.length - 1\r\n                )\r\n            )\r\n        } else if (\r\n            e.type === \"mousemove\" && e.buttons & 1 &&\r\n            this.startPoint\r\n        ) {\r\n            this.updateEllipse(pos, e)\r\n        } else if (\r\n            e.type === \"mouseup\"\r\n        ) {\r\n            if (this.currentBezier) {\r\n                finalizeUndoContext(\"Ellipse\")\r\n\r\n                this.currentBezier = null\r\n                this.startPoint = null\r\n\r\n                this.glyph.emit(\"modified\")\r\n            }\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n    }\r\n\r\n    updateContext(context: IContext) {\r\n        if (!(context instanceof GlyphContext)) return\r\n\r\n        this.glyph = context.glyph\r\n\r\n        this.handles = []\r\n        this.guides = []\r\n        \r\n        for (let bezier of context.beziers) {\r\n            for (let point of bezier.points) {\r\n                this.guides.push(\r\n                    new PointGuide(point.base)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\";\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\";\r\nimport { Point } from \"../../geometry/point\";\r\nimport { ArrayAddAction, ArrayRemoveAction } from \"../../undo/actions/array\";\r\nimport { finalizeUndoContext, undoContext } from \"../../undo/history\";\r\nimport { lerp, unlerp } from \"../../utils/lerp\";\r\nimport { IContext } from \"../context/context\";\r\nimport { GlyphContext } from \"../context/glyph\";\r\nimport { IDrawableHandle } from \"../drawable\";\r\nimport { CurveGuide } from \"../guides/curve\";\r\nimport { IGuide } from \"../guides/guide\";\r\nimport { HandleGuide } from \"../guides/point\";\r\nimport { BezierBasePointHandle } from \"../handles/bezierBasePoint\";\r\nimport { BezierControlPointHandle } from \"../handles/bezierControlPoint\";\r\nimport { Viewport } from \"../viewport\";\r\nimport { ITool, ToolSubAction, ToolSubActionSection } from \"./tool\";\r\n\r\nexport class HandleTool implements ITool {\r\n    public name = \"Curve edit\"\r\n    public icon = \"handletool\"\r\n    public accelerator = \"KeyA\"\r\n\r\n    private selecting = false\r\n    private selectionOrigin: Point\r\n    private selectionTarget: Point\r\n\r\n    private pivotHandle: IDrawableHandle\r\n\r\n    public handles: IDrawableHandle[] = []\r\n    public guides: IGuide[] = []\r\n    public supportsForeignHandles = true\r\n\r\n    private moveStartPoint: Point\r\n    private moveLastPoint: Point\r\n\r\n    private glyph: Glyph\r\n    private beziers: BezierCurve[] = []\r\n\r\n    public subactions: ToolSubActionSection[] = [\r\n        {\r\n            name: \"Edit\",\r\n            subactions: [\r\n                {\r\n                    name: \"Delete\",\r\n                    icon: \"delete\",\r\n                    accelerator: \"Delete\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const curves = this.getSelectedCurves()\r\n    \r\n                        selected.forEach(\r\n                            handle => {\r\n                                if (!(handle instanceof BezierBasePointHandle))\r\n                                    return\r\n                                \r\n                                const point = handle.point\r\n                                const index = point.curve.points.indexOf(point)\r\n    \r\n                                point.curve.points.splice(index, 1)\r\n    \r\n                                const cpHandles = this.handles.filter(\r\n                                    h => h instanceof BezierControlPointHandle &&\r\n                                         h.point === point\r\n                                ) // length always = 2\r\n    \r\n                                const hIndex = this.handles.indexOf(handle)\r\n                                this.handles.splice(hIndex, 1)\r\n    \r\n                                const cpIndex0 = this.handles.indexOf(cpHandles[0])\r\n                                this.handles.splice(cpIndex0, 1)\r\n    \r\n                                const cpIndex1 = this.handles.indexOf(cpHandles[1])\r\n                                this.handles.splice(cpIndex1, 1)\r\n    \r\n                                \r\n                                undoContext.addAction(\r\n                                    new ArrayRemoveAction(\r\n                                        point.curve.points, point,\r\n                                        index\r\n                                    ),\r\n                                    new ArrayRemoveAction(\r\n                                        this.handles, handle,\r\n                                        hIndex\r\n                                    ),\r\n                                    new ArrayRemoveAction(\r\n                                        this.handles, cpHandles[0],\r\n                                        cpIndex0\r\n                                    ),\r\n                                    new ArrayRemoveAction(\r\n                                        this.handles, cpHandles[1],\r\n                                        cpIndex1\r\n                                    )\r\n                                )\r\n                            }\r\n                        )\r\n    \r\n                        finalizeUndoContext(\"Delete points\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Reverse direction\",\r\n                    icon: \"reversecurve\",\r\n                    accelerator: \"KeyR\",\r\n                    handler: () => {\r\n                        this.getSelectedCurves().forEach(\r\n                            c => c.reverse()\r\n                        )\r\n                    }\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name: \"Select\",\r\n            subactions: [\r\n                {\r\n                    name: \"Select all\",\r\n                    icon: \"allsel\",\r\n                    accelerator: \"^KeyA\",\r\n                    handler: () => {\r\n                        this.handles.forEach(\r\n                            handle => handle.selected = true\r\n                        )\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Deselect all\",\r\n                    icon: \"removesel\",\r\n                    accelerator: \"^KeyD\",\r\n                    handler: () => {\r\n                        this.handles.forEach(\r\n                            handle => handle.selected = false\r\n                        )\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Invert selection\",\r\n                    icon: \"invertsel\",\r\n                    accelerator: \"^KeyI\",\r\n                    handler: () => {\r\n                        this.handles.forEach(\r\n                            handle => handle.selected = !handle.selected\r\n                        )\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Select connected\",\r\n                    icon: \"curvesel\",\r\n                    accelerator: \"^KeyL\",\r\n                    handler: () => {\r\n                        const curves = this.getSelectedCurves()\r\n    \r\n                        for (let bezier of curves) {\r\n                            for (let point of bezier.points) {\r\n                                const handle = this.handles.find(\r\n                                    h => h instanceof BezierBasePointHandle &&\r\n                                         h.point === point\r\n                                )\r\n                                if (handle) handle.selected = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name: \"Construct\",\r\n            collapse: true,\r\n            subactions: [\r\n                {\r\n                    name: \"Union\",\r\n                    icon: \"union\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        this.performCSGOperation(\r\n                            (out, item) => out.unite(item, {\r\n                                insert: false\r\n                            })\r\n                        )\r\n    \r\n                        finalizeUndoContext(\"Union\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Difference\",\r\n                    icon: \"difference\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        this.performCSGOperation(\r\n                            (out, item) => out.subtract(item, {\r\n                                insert: false\r\n                            })\r\n                        )\r\n    \r\n                        finalizeUndoContext(\"Difference\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Intersection\",\r\n                    icon: \"intersection\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        this.performCSGOperation(\r\n                            (out, item) => out.intersect(item, {\r\n                                insert: false\r\n                            })\r\n                        )\r\n    \r\n                        finalizeUndoContext(\"Intersection\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Exclusion\",\r\n                    icon: \"xor\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        this.performCSGOperation(\r\n                            (out, item) => out.exclude(item, {\r\n                                insert: false\r\n                            })\r\n                        )\r\n    \r\n                        finalizeUndoContext(\"Exclusion\")\r\n                    }\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name: \"Transform\",\r\n            collapse: true,\r\n            subactions: [\r\n                {\r\n                    name: \"Flip X\",\r\n                    icon: \"flipx\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.x = lerp(\r\n                                1 - unlerp(handle.position.x, bbox.left, bbox.right),\r\n                                bbox.left, bbox.right\r\n                            )\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Flip X\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Flip Y\",\r\n                    icon: \"flipy\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.y = lerp(\r\n                                1 - unlerp(handle.position.y, bbox.top, bbox.bottom),\r\n                                bbox.top, bbox.bottom\r\n                            )\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Flip Y\")\r\n                    }\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            name: \"Alignment\",\r\n            collapse: true,\r\n            subactions: [\r\n                {\r\n                    name: \"Align to left\",\r\n                    icon: \"alignleft\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.x = bbox.left\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to left\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Align to right\",\r\n                    icon: \"alignright\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.x = bbox.right\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to right\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Align to top\",\r\n                    icon: \"aligntop\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.y = bbox.top\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to top\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Align to bottom\",\r\n                    icon: \"alignbottom\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.y = bbox.bottom\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to bottom\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Align to center\",\r\n                    icon: \"alignhcenter\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.y = (bbox.top + bbox.bottom) / 2\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to center\")\r\n                    }\r\n                },\r\n                {\r\n                    name: \"Align to middle\",\r\n                    icon: \"alignvcenter\",\r\n                    accelerator: \"\",\r\n                    handler: () => {\r\n                        const selected = this.handles.filter(h => h.selected)\r\n                        const bbox = this.getHandlesBBox(selected)\r\n    \r\n                        this.addHandlesToUndoContext(selected)\r\n    \r\n                        selected.forEach(handle => {\r\n                            handle.position.x = (bbox.left + bbox.right) / 2\r\n                        })\r\n    \r\n                        finalizeUndoContext(\"Align to middle\")\r\n                    }\r\n                }\r\n            ]\r\n        }\r\n    ]\r\n\r\n    private performCSGOperation(\r\n        operation: (\r\n            out: paper.PathItem, current: paper.PathItem\r\n        ) => paper.PathItem\r\n    ) {\r\n        const curves = this.getSelectedCurves()\r\n        if (!curves.length) return\r\n\r\n        const targetWinding = curves[0].clockwise\r\n\r\n        const paperPaths = curves.map(\r\n            c => c.getPaperPath()\r\n        )\r\n        let out: paper.PathItem = paperPaths[0]\r\n\r\n        let insertIdx = Math.min(\r\n            ...curves.map(c => this.beziers.indexOf(c))\r\n        )\r\n\r\n        for (let i = 1; i < paperPaths.length; i++) {\r\n            out = operation(out, paperPaths[i])\r\n        }\r\n\r\n        const newCurves = BezierCurve.fromPaperPathItem(out)\r\n        if (newCurves.length) {\r\n            const referenceWinding = newCurves[0].clockwise\r\n\r\n            newCurves.forEach(\r\n                c => {\r\n                    c.glyph = this.glyph\r\n\r\n                    if (referenceWinding !== targetWinding)\r\n                        c.reverse()\r\n\r\n                    this.beziers.splice(insertIdx, 0, c)\r\n                    undoContext.addAction(\r\n                        new ArrayAddAction(\r\n                            this.beziers, c, insertIdx\r\n                        )\r\n                    )\r\n\r\n                    const gIdx = this.guides.length\r\n                    const guide = new CurveGuide(c)\r\n                    \r\n                    this.guides.push(guide)\r\n                    undoContext.addAction(\r\n                        new ArrayAddAction(\r\n                            this.guides, guide, gIdx\r\n                        )\r\n                    )\r\n\r\n                    c.points.forEach(\r\n                        p => {\r\n                            const index = this.handles.length\r\n\r\n                            this.handles.push(\r\n                                new BezierControlPointHandle(\r\n                                    p, p.before\r\n                                ),\r\n                                new BezierControlPointHandle(\r\n                                    p, p.after\r\n                                ),\r\n                                new BezierBasePointHandle(\r\n                                    p\r\n                                )\r\n                            )\r\n\r\n                            undoContext.addAction(\r\n                                new ArrayAddAction(\r\n                                    this.handles, this.handles[index],\r\n                                    index\r\n                                ),\r\n                                new ArrayAddAction(\r\n                                    this.handles, this.handles[index + 1],\r\n                                    index + 1\r\n                                ),\r\n                                new ArrayAddAction(\r\n                                    this.handles, this.handles[index + 2],\r\n                                    index + 2\r\n                                )\r\n                            )\r\n                        }\r\n                    )\r\n\r\n                    insertIdx++\r\n                }\r\n            )\r\n        }\r\n\r\n        curves.forEach(\r\n            c => {\r\n                const index = this.beziers.indexOf(c)\r\n                this.beziers.splice(index, 1)\r\n\r\n                undoContext.addAction(\r\n                    new ArrayRemoveAction(\r\n                        this.beziers, c, index\r\n                    )\r\n                )\r\n\r\n                const gIdx = this.guides.findIndex(\r\n                    g => g instanceof CurveGuide &&\r\n                         g.source === c\r\n                )\r\n                this.guides.splice(gIdx, 1)\r\n\r\n                undoContext.addAction(\r\n                    new ArrayRemoveAction(\r\n                        this.guides, this.guides[gIdx],\r\n                        gIdx\r\n                    )\r\n                )\r\n\r\n                this.handles.filter(\r\n                    h => (h instanceof BezierBasePointHandle ||\r\n                         h instanceof BezierControlPointHandle) &&\r\n                         h.point.curve === c\r\n                ).forEach(\r\n                    h => {\r\n                        const index = this.handles.indexOf(h)\r\n                        this.handles.splice(index, 1)\r\n\r\n                        undoContext.addAction(\r\n                            new ArrayRemoveAction(\r\n                                this.handles, h, index\r\n                            )\r\n                        )\r\n                    }\r\n                )\r\n            }\r\n        )\r\n\r\n        this.glyph.emit(\"modifier\")\r\n    }\r\n\r\n    private addHandlesToUndoContext(handles: IDrawableHandle[]) {\r\n        handles.forEach(\r\n            handle => {\r\n                if (!(\"prepareUndo\" in handle)) return\r\n                handle.prepareUndo(undoContext)\r\n            }\r\n        )\r\n    }\r\n\r\n    private getHandlesBBox(handles: IDrawableHandle[]): {\r\n        left: number, top: number,\r\n        right: number, bottom: number\r\n    } {\r\n        const xs = handles.map(h => h.position.x)\r\n        const ys = handles.map(h => h.position.y)\r\n\r\n        return {\r\n            left: Math.min(...xs),\r\n            top: Math.min(...ys),\r\n            right: Math.max(...xs),\r\n            bottom: Math.max(...ys)\r\n        }\r\n    }\r\n\r\n    private selectHandleBox(exclusive = true) {\r\n        const left = Math.min(\r\n            this.selectionOrigin.x, this.selectionTarget.x\r\n        )\r\n        const right = Math.max(\r\n            this.selectionOrigin.x, this.selectionTarget.x\r\n        )\r\n        const top = Math.min(\r\n            this.selectionOrigin.y, this.selectionTarget.y\r\n        )\r\n        const bottom = Math.max(\r\n            this.selectionOrigin.y, this.selectionTarget.y\r\n        )\r\n\r\n        for (let handle of this.handles) {\r\n            const selected = handle.position.x >= left &&\r\n                             handle.position.x < right &&\r\n                             handle.position.y >= top &&\r\n                             handle.position.y < bottom\r\n\r\n            if (exclusive)\r\n                handle.selected = selected\r\n            else\r\n                handle.selected = selected || handle.selected\r\n        }\r\n    }\r\n\r\n    private getSelectedCurves(): BezierCurve[] {\r\n        const curves: BezierCurve[] = []\r\n        \r\n        for (let handle of this.handles) {\r\n            if (\r\n                !handle.selected ||\r\n                !(handle instanceof BezierBasePointHandle)\r\n            )\r\n                continue\r\n            \r\n            if (!curves.includes(handle.point.curve))\r\n                curves.push(handle.point.curve)\r\n        }\r\n\r\n        return curves\r\n    }\r\n\r\n    handleMouseEvent(v: Viewport, e: MouseEvent, x: number, y: number) {\r\n        const pos = v.co.clientToWorld(\r\n            x, y\r\n        )\r\n\r\n        if (this.moveStartPoint) v.restrictAngles(this.moveStartPoint, pos, e)\r\n\r\n        if (\r\n            e.type === \"mousedown\" && e.buttons & 1\r\n        ) {\r\n            const handle = v.nearHandle(pos.x, pos.y)\r\n            if (!handle) {\r\n                this.pivotHandle = null\r\n                v.selectHandles([], !e.shiftKey)\r\n\r\n                this.selecting = true\r\n                this.selectionOrigin = pos\r\n                this.selectionTarget = pos\r\n            } else {\r\n                this.pivotHandle = handle\r\n                if (!handle.selected) {\r\n                    v.selectHandles([handle], !e.shiftKey)\r\n                }\r\n\r\n                this.addHandlesToUndoContext(\r\n                    v.getSelectedHandles()\r\n                )\r\n                \r\n\r\n                // First movement - snapping to the cursor\r\n                // const dPos = pos.getDiff(this.pivotHandle.position)\r\n                // this.pivotHandle.move(\r\n                //     v, pos, dPos, this.pivotHandle, e\r\n                // )\r\n\r\n                // for (let handle of this.handles) {\r\n                //     if (\r\n                //         handle.selected &&\r\n                //         handle !== this.pivotHandle &&\r\n                //         handle.type === this.pivotHandle.type\r\n                //     )\r\n                //         handle.move(\r\n                //             v, pos, dPos, this.pivotHandle, e\r\n                //         )\r\n                // }\r\n\r\n                this.moveStartPoint = pos\r\n                this.moveLastPoint = pos\r\n            }\r\n        } else if (\r\n            e.type === \"mousemove\" && e.buttons & 1\r\n        ) {\r\n            if (this.selecting) {\r\n                this.selectionTarget = pos\r\n            } else {\r\n                if (!this.pivotHandle) return\r\n\r\n                const rawX = pos.x, rawY = pos.y\r\n                v.nudgePoint(pos, this.pivotHandle)\r\n\r\n                const inPointDiff = this.moveLastPoint.getDiff(\r\n                    this.pivotHandle.position\r\n                )\r\n\r\n                const dPos = pos.getDiff(this.moveLastPoint)\r\n                this.moveLastPoint = pos\r\n\r\n                if (rawX !== pos.x || rawY !== pos.y) {\r\n                    // Center on cursor when snapping happens\r\n                    pos.x -= inPointDiff.x\r\n                    pos.y -= inPointDiff.y\r\n                }\r\n\r\n                // Pivot gets moved first\r\n                this.pivotHandle.move(\r\n                    v, pos, dPos, this.pivotHandle, e\r\n                )\r\n\r\n                for (let handle of this.handles) {\r\n                    if (\r\n                        handle.selected &&\r\n                        handle !== this.pivotHandle &&\r\n                        handle.type === this.pivotHandle.type\r\n                    )\r\n                        handle.move(\r\n                            v, pos, dPos, this.pivotHandle, e\r\n                        )\r\n                }\r\n            }\r\n        } else if (\r\n            e.type === \"mouseup\"\r\n        ) {\r\n            if (this.selecting) {\r\n                this.selectHandleBox(!e.shiftKey)\r\n                this.selecting = false\r\n            } else {\r\n                v.disableAllGuides()\r\n\r\n                if (v.getSelectedHandles().length)\r\n                    finalizeUndoContext(\"Move points\")\r\n            }\r\n\r\n            this.moveStartPoint = null\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n        if (this.selecting) {\r\n            ctx.fillStyle = \"#08f3\"\r\n            ctx.fillRect(\r\n                this.selectionOrigin.x,\r\n                this.selectionOrigin.y,\r\n                this.selectionTarget.x - this.selectionOrigin.x,\r\n                this.selectionTarget.y - this.selectionOrigin.y\r\n            )\r\n        }\r\n    }\r\n\r\n    updateContext(context: IContext) {\r\n        if (!(context instanceof GlyphContext)) return\r\n\r\n        this.glyph = context.glyph\r\n        this.beziers = context.beziers\r\n\r\n        this.handles = []\r\n        context.beziers.forEach(\r\n            bezier => {\r\n                bezier.points.forEach(\r\n                    p => this.handles.push(\r\n                        new BezierControlPointHandle(p, p.before),\r\n                        new BezierControlPointHandle(p, p.after),\r\n                        new BezierBasePointHandle(p)\r\n                    )\r\n                )\r\n            }\r\n        )\r\n\r\n        this.guides = this.handles.filter(\r\n            h => h instanceof BezierBasePointHandle\r\n        ).map(\r\n            h => new HandleGuide(h)\r\n        )\r\n    }\r\n}","import { Glyph } from \"../../font/glyph\";\r\nimport { BezierCurve } from \"../../geometry/bezier/curve\";\r\nimport { BezierPoint } from \"../../geometry/bezier/point\";\r\nimport { Point } from \"../../geometry/point\";\r\nimport { ArrayAddAction } from \"../../undo/actions/array\";\r\nimport { finalizeUndoContext, undoContext } from \"../../undo/history\";\r\nimport { BezierContext } from \"../context/bezier\";\r\nimport { IContext } from \"../context/context\";\r\nimport { GlyphContext } from \"../context/glyph\";\r\nimport { IDrawableHandle } from \"../drawable\";\r\nimport { IGuide } from \"../guides/guide\";\r\nimport { PointGuide } from \"../guides/point\";\r\nimport { Viewport } from \"../viewport\";\r\nimport { ITool, ToolSubAction, ToolSubActionSection } from \"./tool\";\r\n\r\nexport class RectangleTool implements ITool {\r\n    public name = \"Rectangle\"\r\n    public icon = \"rectangletool\"\r\n    public accelerator = \"KeyS\"\r\n\r\n    public handles: IDrawableHandle[] = []\r\n    public guides: IGuide[] = []\r\n    public supportsForeignHandles = false\r\n\r\n    public subactions: ToolSubActionSection[] = []\r\n\r\n    private startPoint: Point\r\n\r\n    private glyph: Glyph\r\n\r\n    private currentBezier: BezierCurve\r\n\r\n    createRect(): BezierCurve {\r\n        const curve = new BezierCurve(this.glyph)\r\n\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n        curve.addPoint(\r\n            new BezierPoint(\r\n                new Point(0, 0),\r\n                new Point(0, 0),\r\n                new Point(0, 0)\r\n            )\r\n        )\r\n\r\n        curve.points.forEach(p => p.determineType())\r\n\r\n        return curve\r\n    }\r\n\r\n    updateRectangle(pos: Point, e: MouseEvent) {\r\n        const min = new Point(\r\n            this.startPoint.x, this.startPoint.y\r\n        )\r\n        const max = new Point(pos.x, pos.y)\r\n\r\n        if (e.shiftKey) {\r\n            const w = max.x - min.x\r\n            const h = max.y - min.y\r\n\r\n            const size = Math.min(\r\n                Math.abs(w), Math.abs(h)\r\n            )\r\n\r\n            max.x = Math.sign(w) * size + min.x\r\n            max.y = Math.sign(h) * size + min.y\r\n        }\r\n        if (e.ctrlKey) {\r\n            min.x = 2 * min.x - max.x\r\n            min.y = 2 * min.y - max.y\r\n        }\r\n\r\n        this.currentBezier.points[0].base.x = min.x\r\n        this.currentBezier.points[0].base.y = min.y\r\n        this.currentBezier.points[0].before.x = min.x\r\n        this.currentBezier.points[0].before.y = min.y\r\n        this.currentBezier.points[0].after.x = min.x\r\n        this.currentBezier.points[0].after.y = min.y\r\n\r\n        this.currentBezier.points[1].base.x = max.x\r\n        this.currentBezier.points[1].base.y = min.y\r\n        this.currentBezier.points[1].before.x = max.x\r\n        this.currentBezier.points[1].before.y = min.y\r\n        this.currentBezier.points[1].after.x = max.x\r\n        this.currentBezier.points[1].after.y = min.y\r\n\r\n        this.currentBezier.points[2].base.x = max.x\r\n        this.currentBezier.points[2].base.y = max.y\r\n        this.currentBezier.points[2].before.x = max.x\r\n        this.currentBezier.points[2].before.y = max.y\r\n        this.currentBezier.points[2].after.x = max.x\r\n        this.currentBezier.points[2].after.y = max.y\r\n\r\n        this.currentBezier.points[3].base.x = min.x\r\n        this.currentBezier.points[3].base.y = max.y\r\n        this.currentBezier.points[3].before.x = min.x\r\n        this.currentBezier.points[3].before.y = max.y\r\n        this.currentBezier.points[3].after.x = min.x\r\n        this.currentBezier.points[3].after.y = max.y\r\n    }\r\n\r\n    handleMouseEvent(\r\n        v: Viewport, e: MouseEvent, x: number, y: number\r\n    ) {\r\n        if (!(v.context instanceof BezierContext)) return\r\n\r\n        const pos = v.co.clientToWorld(\r\n            x, y\r\n        )\r\n        v.nudgePoint(pos)\r\n\r\n        if (\r\n            e.type === \"mousedown\" && e.buttons & 1\r\n        ) {\r\n            this.currentBezier = this.createRect()\r\n            this.startPoint = pos\r\n\r\n            this.updateRectangle(pos, e)\r\n\r\n            v.context.beziers.push(this.currentBezier)\r\n            \r\n            undoContext.addAction(\r\n                new ArrayAddAction(\r\n                    v.context.beziers, this.currentBezier,\r\n                    v.context.beziers.length - 1\r\n                )\r\n            )\r\n        } else if (\r\n            e.type === \"mousemove\" && e.buttons & 1 &&\r\n            this.startPoint\r\n        ) {\r\n            this.updateRectangle(pos, e)\r\n        } else if (\r\n            e.type === \"mouseup\"\r\n        ) {\r\n            if (this.currentBezier) {\r\n                finalizeUndoContext(\"Rectangle\")\r\n\r\n                this.currentBezier = null\r\n                this.startPoint = null\r\n\r\n                this.glyph.emit(\"modified\")\r\n            }\r\n        }\r\n    }\r\n\r\n    render(v: Viewport, ctx: CanvasRenderingContext2D) {\r\n    }\r\n\r\n    updateContext(context: IContext) {\r\n        if (!(context instanceof GlyphContext)) return\r\n\r\n        this.glyph = context.glyph\r\n\r\n        this.handles = []\r\n        this.guides = []\r\n        \r\n        for (let bezier of context.beziers) {\r\n            for (let point of bezier.points) {\r\n                this.guides.push(\r\n                    new PointGuide(point.base)\r\n                )\r\n            }\r\n        }\r\n    }\r\n}","import { throws } from \"assert\"\r\nimport { Point } from \"../geometry/point\"\r\nimport { IContext } from \"./context/context\"\r\nimport { ViewportCoordinates } from \"./coordinates\"\r\nimport { IDrawableHandle } from \"./drawable\"\r\nimport { CurveGuide } from \"./guides/curve\"\r\nimport { GridGuide } from \"./guides/grid\"\r\nimport { IGuide } from \"./guides/guide\"\r\nimport { HorizontalGuide, VerticalGuide } from \"./guides/line\"\r\nimport { PointGuide } from \"./guides/point\"\r\nimport { ITool } from \"./tools/tool\"\r\nimport { MenuItem, MenuItemConstructorOptions, remote } from \"electron\"\r\nimport { accelStringToElectron } from \"../utils/accelerator\"\r\n\r\nexport class Viewport {\r\n    public domCanvas = document.createElement(\"canvas\")\r\n    private ctx = this.domCanvas.getContext(\"2d\")\r\n\r\n    public co = new ViewportCoordinates()\r\n\r\n    constructor(\r\n        public context: IContext,\r\n        public handles: IDrawableHandle[],\r\n        public tool: ITool\r\n    ) {\r\n        this.setupCanvasEvents()\r\n    }\r\n\r\n    dispatchMouseEvent(e: MouseEvent) {\r\n        const box = this.domCanvas.getBoundingClientRect()\r\n        if (!this.tool) return\r\n\r\n        this.tool.handleMouseEvent(\r\n            this, e,\r\n            e.clientX - box.left, e.clientY - box.top\r\n        )\r\n        this.render()\r\n    }\r\n\r\n    private setupCanvasEvents() {\r\n        this.domCanvas.addEventListener(\"click\", (e) => {\r\n        })\r\n\r\n        this.domCanvas.addEventListener(\"mousedown\", (e) => {\r\n            this.dispatchMouseEvent(e)\r\n        })\r\n\r\n        this.domCanvas.addEventListener(\"contextmenu\", () => {\r\n            const menuItems: MenuItemConstructorOptions[] = []\r\n            \r\n            this.tool.subactions.forEach(\r\n                (section, i) => {\r\n                    if (section.collapse) {\r\n                        menuItems.push({\r\n                            type: \"submenu\",\r\n                            label: section.name,\r\n                            submenu: section.subactions.map(\r\n                                a => {\r\n                                    return {\r\n                                        label: a.name,\r\n                                        click: () => a.handler(),\r\n                                        accelerator: accelStringToElectron(a.accelerator)\r\n                                    }\r\n                                }\r\n                            )\r\n                        })\r\n                    } else {\r\n                        menuItems.push(\r\n                            ...section.subactions.map(\r\n                                a => {\r\n                                    return {\r\n                                        label: a.name,\r\n                                        click: () => a.handler(),\r\n                                        accelerator: accelStringToElectron(a.accelerator)\r\n                                    }\r\n                                }\r\n                            )\r\n                        )\r\n                    }\r\n\r\n                    if (i < this.tool.subactions.length - 1) {\r\n                        menuItems.push({\r\n                            type: \"separator\"\r\n                        })\r\n                    }\r\n                }\r\n            )\r\n\r\n            const menu = remote.Menu.buildFromTemplate(menuItems)\r\n\r\n            menu.popup()\r\n        })\r\n\r\n        this.domCanvas.addEventListener(\"mouseup\", (e) => {\r\n            this.dispatchMouseEvent(e)\r\n        })\r\n\r\n        this.domCanvas.addEventListener(\"mousemove\", (e) => {\r\n            if (e.buttons & 4) { // Middle Button\r\n                this.co.translate(e.movementX, e.movementY)\r\n                this.render()\r\n            } else {\r\n                this.dispatchMouseEvent(e)\r\n            }\r\n        })\r\n\r\n        this.domCanvas.addEventListener(\"wheel\", (e) => {\r\n            if (e.buttons & 4 || e.ctrlKey) { // Middle Button\r\n                const box = this.domCanvas.getBoundingClientRect()\r\n                const pos = this.co.clientToWorld(\r\n                    e.clientX - box.left, e.clientY - box.top\r\n                )\r\n\r\n                this.co.scale(\r\n                    1.2 ** Math.sign(-e.deltaY),\r\n                    pos.x, pos.y\r\n                )\r\n                this.render()\r\n            } else {\r\n                if (e.shiftKey && !e.deltaX) {\r\n                    this.co.translate(\r\n                        -e.deltaY, 0\r\n                    )\r\n                } else {\r\n                    this.co.translate(\r\n                        -e.deltaX, -e.deltaY\r\n                    )\r\n                }\r\n                this.render()\r\n            }\r\n        })\r\n    }\r\n\r\n    nearHandle(\r\n        x: number, y: number,\r\n        type?: string\r\n    ): IDrawableHandle {\r\n        const handles = [\r\n            ...this.context.handles,\r\n            ...this.tool.handles\r\n        ]\r\n\r\n        for (let i = handles.length - 1; i >= 0; i--) {\r\n            const handle = handles[i]\r\n\r\n            if (type && handle.type !== type || handle.hidden)\r\n                continue\r\n\r\n            const dist = Math.hypot(\r\n                handle.position.x - x,\r\n                handle.position.y - y\r\n            )\r\n\r\n            if (dist < handle.hitRadius / this.co.scaleFactor)\r\n                return handle\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n    selectHandles(\r\n        select: IDrawableHandle[],\r\n        exclusive = true\r\n    ) {\r\n        const handles = [\r\n            ...this.context.handles,\r\n            ...this.tool.handles\r\n        ]\r\n\r\n        if (exclusive) {\r\n            for (let handle of handles) {\r\n                handle.selected = false\r\n            }\r\n        }\r\n\r\n        for (let handle of select) {\r\n            handle.selected = true\r\n        }\r\n    }\r\n\r\n    getSelectedHandles() {\r\n        const handles = [\r\n            ...this.context.handles,\r\n            ...this.tool.handles\r\n        ]\r\n\r\n        return handles.filter(h => h.selected)\r\n    }\r\n\r\n    purgeHandles() {\r\n        this.handles = []\r\n    }\r\n\r\n    updateViewportSize(autoCenter = true) {\r\n        const parent = this.domCanvas.parentElement\r\n        if (!parent) return\r\n\r\n        const rect = parent.getBoundingClientRect()\r\n\r\n        if (autoCenter) {\r\n            this.co.translate(\r\n                (rect.width - this.domCanvas.width) / 2,\r\n                (rect.height - this.domCanvas.height) / 2\r\n            )\r\n        }\r\n        this.domCanvas.width = rect.width\r\n        this.domCanvas.height = rect.height\r\n\r\n        this.render()\r\n    }\r\n\r\n    drawHandles(handles: IDrawableHandle[]) {\r\n        for (let handle of handles) {\r\n            const clientPos = this.co.worldToClient(\r\n                handle.position.x, handle.position.y\r\n            )\r\n\r\n            this.ctx.resetTransform()\r\n            this.ctx.translate(\r\n                Math.round(clientPos.x) + 0.5,\r\n                Math.round(clientPos.y) + 0.5\r\n            )\r\n\r\n            handle.render(this, this.ctx)\r\n        }\r\n    }\r\n\r\n    nudgeToGuides(pos: Point, obj: any, guides: IGuide[]) {\r\n        const nudgedPoints: Point[] = []\r\n        \r\n        guides.forEach(\r\n            g => {\r\n                const point = g.nudge(this, pos, obj)\r\n                if (point && pos.distance(point))\r\n                    nudgedPoints.push(point)\r\n            }\r\n        )\r\n\r\n        if (nudgedPoints.length) {\r\n            const distances = nudgedPoints.map(p => p.distance(pos))\r\n            const minDist = Math.min(...distances)\r\n            const minIndex = distances.indexOf(minDist)\r\n\r\n            pos.copy(nudgedPoints[minIndex])\r\n        }\r\n    }\r\n\r\n    nudgePoint(pos: Point, obj?: any) {\r\n        const guides = [\r\n            ...this.context.guides,\r\n            ...this.tool.guides\r\n        ]\r\n\r\n        this.nudgeToGuides(\r\n            pos, obj,\r\n            guides.filter(g => g instanceof CurveGuide)\r\n        )\r\n        this.nudgeToGuides(pos, obj, this.context.grids)\r\n        this.nudgeToGuides(\r\n            pos, obj,\r\n            guides.filter(\r\n                g => g instanceof HorizontalGuide ||\r\n                     g instanceof VerticalGuide\r\n            )\r\n        )\r\n        this.nudgeToGuides(\r\n            pos, obj,\r\n            guides.filter(g => g instanceof PointGuide)\r\n        )\r\n    }\r\n\r\n    restrictAngles(start: Point, pos: Point, e: MouseEvent) {\r\n        const dx = Math.abs(pos.x - start.x)\r\n        const dy = Math.abs(pos.y - start.y)\r\n\r\n        if (e.shiftKey) {\r\n            if (dx > dy)\r\n                pos.y = start.y\r\n            else\r\n                pos.x = start.x\r\n        }\r\n    }\r\n\r\n    disableAllGuides() {\r\n        this.context.grids.forEach(\r\n            g => g.active = false\r\n        )\r\n        this.context.guides.forEach(\r\n            g => g.active = false\r\n        )\r\n        this.tool.guides.forEach(\r\n            g => g.active = false\r\n        )\r\n    }\r\n\r\n    render() {\r\n        this.ctx.resetTransform()\r\n        this.ctx.clearRect(\r\n            0, 0, this.domCanvas.width, this.domCanvas.height\r\n        )\r\n\r\n        this.co.transformCanvas(this.ctx)\r\n\r\n        this.context.render(this, this.ctx)\r\n        \r\n        this.ctx.resetTransform()\r\n        \r\n        this.context.grids.forEach(\r\n            g => g.render(this, this.ctx)\r\n        )\r\n\r\n        Array(\r\n            ...this.context.guides,\r\n            ...this.tool.guides\r\n        ).forEach(\r\n            guide => {\r\n                if (guide.active || guide instanceof GridGuide) {\r\n                    this.ctx.resetTransform()\r\n                    if (guide.worldRender)\r\n                        this.co.transformCanvas(this.ctx)\r\n                        \r\n                    guide.render(this, this.ctx)\r\n                }\r\n            }\r\n        )\r\n\r\n        if (this.tool && this.tool.supportsForeignHandles) {\r\n            this.drawHandles(this.context.handles)\r\n            this.drawHandles(this.handles)\r\n        }\r\n        if (this.tool) {\r\n            this.drawHandles(this.tool.handles)\r\n        }\r\n\r\n        this.ctx.resetTransform()\r\n        this.co.transformCanvas(this.ctx)\r\n        if (this.tool)\r\n            this.tool.render(this, this.ctx)\r\n    }\r\n\r\n    setTool(tool: ITool) {\r\n        this.tool = tool\r\n        this.tool.updateContext(this.context)\r\n        this.disableAllGuides()\r\n        this.render()\r\n    }\r\n}","module.exports = require(\"child_process\");","module.exports = require(\"electron\");","module.exports = require(\"events\");","module.exports = require(\"fs\");","module.exports = require(\"opentype.js\");","module.exports = require(\"paper\");","module.exports = require(\"path\");","module.exports = require(\"smart-buffer\");","module.exports = require(\"zlib\");"],"sourceRoot":""}